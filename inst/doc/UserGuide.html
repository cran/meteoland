<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Miquel De Cáceres, Victor Granda" />

<meta name="date" content="2019-04-29" />

<title>User’s guide</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceLine, a.sourceLine { display: inline-block; min-height: 1.25em; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; }
@media print {
code.sourceCode { white-space: pre-wrap; }
div.sourceLine, a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource div.sourceLine, .numberSource a.sourceLine
  { position: relative; }
pre.numberSource div.sourceLine::before, .numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em; }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; color: #aaaaaa;  padding-left: 4px; }
@media screen {
a.sourceLine::before { text-decoration: underline; color: initial; }
}
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.bn { color: #40a070; } /* BaseN */
code span.fl { color: #40a070; } /* Float */
code span.ch { color: #4070a0; } /* Char */
code span.st { color: #4070a0; } /* String */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.ot { color: #007020; } /* Other */
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.fu { color: #06287e; } /* Function */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code span.cn { color: #880000; } /* Constant */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.ss { color: #bb6688; } /* SpecialString */
code span.im { } /* Import */
code span.va { color: #19177c; } /* Variable */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.op { color: #666666; } /* Operator */
code span.bu { } /* BuiltIn */
code span.ex { } /* Extension */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.at { color: #7d9029; } /* Attribute */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">User’s guide</h1>
<h4 class="author">Miquel De Cáceres, Victor Granda</h4>
<h4 class="date">2019-04-29</h4>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a><ul>
<li><a href="#purpose">Purpose</a></li>
<li><a href="#installing-and-loading-the-package">Installing and loading the package</a></li>
</ul></li>
<li><a href="#interpolation-of-daily-weather">Interpolation of daily weather</a><ul>
<li><a href="#preparing-weather-data-for-interpolation">Preparing weather data for interpolation</a></li>
<li><a href="#building-an-interpolation-data-object">Building an interpolation data object</a></li>
<li><a href="#interpolation-basics-and-parameters">Interpolation basics and parameters</a></li>
<li><a href="#calibration-and-cross-validation-of-the-interpolation-data">Calibration and cross-validation of the interpolation data</a></li>
<li><a href="#interpolation-on-a-grid">Interpolation on a grid</a></li>
<li><a href="#interpolation-on-a-set-of-points">Interpolation on a set of points</a></li>
</ul></li>
<li><a href="#statistical-correction-of-daily-weather">Statistical correction of daily weather</a><ul>
<li><a href="#preparing-weather-data-to-be-downscaledcorrected">Preparing weather data to be downscaled/corrected</a></li>
<li><a href="#building-the-uncorrected-data-object">Building the uncorrected data object</a></li>
<li><a href="#target-point-weather-meteorology-taken-as-reference">Target point weather meteorology taken as reference</a></li>
<li><a href="#tuning-correction-parameters">Tuning correction parameters</a></li>
<li><a href="#conducting-statistical-correction">Conducting statistical correction</a></li>
</ul></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>Introduction</h1>
<div id="purpose" class="section level2">
<h2>Purpose</h2>
<p>Reliable meteorological data are a basic requirement for hydrological and ecological studies at the landscape scale. Given the large spatial variation of meteorology over complex terrains, meteorological records from a single weather station are often not representative of entire landscapes. Studies made on multiple sites over a landscape require different meteorological series for each site; and other studies may require meteorological data series for all grid cells of a landscape, in a continuous way. In these cases, spatial correlation between the meteorology series of different sites or cells must be taken into account. For example, the sequence of days with rain of contiguous cells will normally be the same or very similar, even if precipitation amounts may differ. Finally, studies addressing the impacts of climate change on forests and landscapes require downscaling coarse-scale predictions of global or regional climate models to the landscape scale. When downscaling predictions for several locations in a landscape, spatial correlation of predictions is also important.</p>
<p>With the aim to assist research of climatic impacts on forests, the R package <code>meteoland</code> provides utilities to estimate daily weather variables at any position over complex terrains:</p>
<ol style="list-style-type: decimal">
<li>Spatial interpolation of daily weather records from meteorological stations. }</li>
<li>Statistical correction of meteorological data series (e.g. from climate models).}</li>
</ol>
<p>Using <code>meteoland</code> package is easy, but some ideas and concepts must be addresed to make the experience easy for new users. This vignette is intended as a working example to explain all the steps needed to get comfortable with <code>meteoland</code> workflow. We assume that the reader is more or less familiar with S4 classes of package <strong>sp</strong>. You will find detailed information regarding the package structure, its functions, and how calculations are done in vignette “<strong>Package meteoland</strong>”.</p>
</div>
<div id="installing-and-loading-the-package" class="section level2">
<h2>Installing and loading the package</h2>
<p>First of all, before starting to work with the package, we must install and load the library. <code>meteoland</code> stable version can be found at CRAN (<a href="https://CRAN.R-project.org/package=meteoland" class="uri">https://CRAN.R-project.org/package=meteoland</a>), and it can be installed and loaded as any other R package:</p>
<pre class="sourceCode r" id="cb1"><code class="sourceCode r"><div class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">&quot;meteoland&quot;</span>)</div>
<div class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(meteoland)</div></code></pre>
<p>Alternatively, you can install the development version located at GitHub using the <code>devtools</code> package:</p>
<pre class="sourceCode r" id="cb2"><code class="sourceCode r"><div class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(devtools)</div>
<div class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">install_github</span>(<span class="st">&quot;miquelcaceres/meteoland&quot;</span>, <span class="dt">build_vignettes =</span> <span class="ot">TRUE</span>)</div>
<div class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">library</span>(meteoland)</div></code></pre>
</div>
</div>
<div id="interpolation-of-daily-weather" class="section level1">
<h1>Interpolation of daily weather</h1>
<p>Spatial interpolation is required when meteorology for the area and period of interest cannot be obtained from local sensors. The nearest weather station may not have data for the period of interest or it may be located too far away to be representative of the target area.</p>
<div id="preparing-weather-data-for-interpolation" class="section level2">
<h2>Preparing weather data for interpolation</h2>
<p>Before starting using the package, you need to have access to the elevation (in m) and daily weather data series corresponding a set of locations (normally weather stations). Elevation is needed because interpolation routines perform corrections for differences in elevation between the reference locations and the target point. The initial format of your data will be different depending on the format used by your data provider (the package has also tools to access weather data). For our example, we will assume you have data from a set of 38 stations in your study area. On one hand, you should have a <code>data.frame</code> with the coordinates and elevation of each location:</p>
<pre class="sourceCode r" id="cb3"><code class="sourceCode r"><div class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">str</span>(st_data)</div>
<div class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; 'data.frame':    38 obs. of  3 variables:</span></div>
<div class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt;  $ X_UTM    : num  347104 358240 382829 350600 377232 ...</span></div>
<div class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt;  $ Y_UTM    : num  4614634 4615380 4645816 4616925 4628439 ...</span></div>
<div class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt;  $ elevation: int  428 555 689 429 632 490 445 687 330 329 ...</span></div>
<div class="sourceLine" id="cb3-6" data-line-number="6"><span class="kw">head</span>(st_data)</div>
<div class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt;     X_UTM   Y_UTM elevation</span></div>
<div class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt; C7 347104 4614634       428</span></div>
<div class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt; C8 358240 4615380       555</span></div>
<div class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt; CA 382829 4645816       689</span></div>
<div class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; VD 350600 4616925       429</span></div>
<div class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; VP 377232 4628439       632</span></div>
<div class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; W5 360730 4659875       490</span></div></code></pre>
<p>On the other, you should have at least three matrices of meteorological data (one for minimum temperature, one for maximum temperature and the last one for precipitation) with stations in rows and dates in columns. In our example we also add relative humidity (in percent), so that other derived variables can be calculated:</p>
<pre class="sourceCode r" id="cb4"><code class="sourceCode r"><div class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">dim</span>(tmax)</div>
<div class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; [1]   38 1461</span></div>
<div class="sourceLine" id="cb4-3" data-line-number="3"><span class="kw">dim</span>(tmin)</div>
<div class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; [1]   38 1461</span></div>
<div class="sourceLine" id="cb4-5" data-line-number="5"><span class="kw">dim</span>(prec)</div>
<div class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; [1]   38 1461</span></div>
<div class="sourceLine" id="cb4-7" data-line-number="7"><span class="kw">dim</span>(rhum)</div>
<div class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; [1]   38 1461</span></div>
<div class="sourceLine" id="cb4-9" data-line-number="9">tmax[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>]</div>
<div class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt;    2000-01-01 2000-01-02 2000-01-03 2000-01-04 2000-01-05 2000-01-06</span></div>
<div class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt; C7        8.8        8.8       10.7        2.9        1.3       -0.2</span></div>
<div class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; C8        7.9        8.0        9.9        3.2        3.3       -0.4</span></div>
<div class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; CA       11.5       13.4       13.5       10.6       14.9       12.7</span></div>
<div class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt; VD        7.4        8.0        9.3        2.8        1.4       -0.2</span></div>
<div class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; VP        4.8        8.1        8.9        2.3        9.0       -1.4</span></div>
<div class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; W5         NA         NA         NA         NA         NA         NA</span></div></code></pre>
<p>Units should be in degrees Celsius for temperature and mm for precipitation.</p>
</div>
<div id="building-an-interpolation-data-object" class="section level2">
<h2>Building an interpolation data object</h2>
<p>Meteoland stores weather series for reference locations and interpolation parameters in a single object of class <code>MeteorologyInterpolationData</code>. There are several ways of building such objects, but we will first illustrate how to do it from the data we just presented.</p>
<p>First we need to create an object of class <code>SpatialPoints</code> (see package <strong>sp</strong>) with the spatial coordinates of our stations and the coordinate system (here UTM 31N):</p>
<pre class="sourceCode r" id="cb5"><code class="sourceCode r"><div class="sourceLine" id="cb5-1" data-line-number="1">sp =<span class="st"> </span><span class="kw">SpatialPoints</span>(st_data[,<span class="kw">c</span>(<span class="st">&quot;X_UTM&quot;</span>, <span class="st">&quot;Y_UTM&quot;</span>)],</div>
<div class="sourceLine" id="cb5-2" data-line-number="2">                   <span class="dt">proj4string =</span> <span class="kw">CRS</span>(<span class="st">&quot;+proj=utm +zone=31 +ellps=WGS84 +datum=WGS84 +units=m +towgs84=0,0,0&quot;</span>))</div>
<div class="sourceLine" id="cb5-3" data-line-number="3"><span class="kw">head</span>(sp)</div>
<div class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; SpatialPoints:</span></div>
<div class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt;     X_UTM   Y_UTM</span></div>
<div class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; C7 347104 4614634</span></div>
<div class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; C8 358240 4615380</span></div>
<div class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; CA 382829 4645816</span></div>
<div class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; VD 350600 4616925</span></div>
<div class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; VP 377232 4628439</span></div>
<div class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; W5 360730 4659875</span></div>
<div class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; Coordinate Reference System (CRS) arguments: +proj=utm +zone=31</span></div>
<div class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; +ellps=WGS84 +datum=WGS84 +units=m +towgs84=0,0,0</span></div></code></pre>
<p>We can now build an object <code>MeteorologyInterpolationData</code> using:</p>
<pre class="sourceCode r" id="cb6"><code class="sourceCode r"><div class="sourceLine" id="cb6-1" data-line-number="1">interpolator &lt;-<span class="st"> </span><span class="kw">MeteorologyInterpolationData</span>(sp, <span class="dt">elevation =</span> st_data<span class="op">$</span>elevation,</div>
<div class="sourceLine" id="cb6-2" data-line-number="2">                                             <span class="dt">MinTemperature =</span> tmin,</div>
<div class="sourceLine" id="cb6-3" data-line-number="3">                                             <span class="dt">MaxTemperature =</span> tmax,</div>
<div class="sourceLine" id="cb6-4" data-line-number="4">                                             <span class="dt">Precipitation =</span> prec,</div>
<div class="sourceLine" id="cb6-5" data-line-number="5">                                             <span class="dt">RelativeHumidity =</span> rhum)</div>
<div class="sourceLine" id="cb6-6" data-line-number="6"><span class="kw">class</span>(interpolator)</div>
<div class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; [1] &quot;MeteorologyInterpolationData&quot;</span></div>
<div class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; attr(,&quot;package&quot;)</span></div>
<div class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; [1] &quot;meteoland&quot;</span></div></code></pre>
<p>The resulting object is now ready to be used to perform interpolation on a set of target locations (see next section). We can inspect the amount of data in our interpolation object using function <code>interpolation.coverage</code>. For example, with:</p>
<pre class="sourceCode r" id="cb7"><code class="sourceCode r"><div class="sourceLine" id="cb7-1" data-line-number="1">spatial_coverage &lt;-<span class="st"> </span><span class="kw">interpolation.coverage</span>(interpolator, <span class="dt">type =</span> <span class="st">'spatial'</span>)</div>
<div class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">head</span>(spatial_coverage)</div>
<div class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt;          coordinates MinTemperature MaxTemperature Precipitation</span></div>
<div class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; C7 (347104, 4614634)           1456           1454          1456</span></div>
<div class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; C8 (358240, 4615380)           1450           1449          1450</span></div>
<div class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; CA (382829, 4645816)           1444           1444          1444</span></div>
<div class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; VD (350600, 4616925)           1461           1461          1461</span></div>
<div class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; VP (377232, 4628439)           1461           1461          1461</span></div>
<div class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; W5 (360730, 4659875)           1288           1288          1288</span></div>
<div class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt;    RelativeHumidity Radiation WindSpeed WindDirection</span></div>
<div class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; C7             1444         0         0             0</span></div>
<div class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; C8             1405         0         0             0</span></div>
<div class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; CA             1378         0         0             0</span></div>
<div class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt; VD             1461         0         0             0</span></div>
<div class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; VP             1455         0         0             0</span></div>
<div class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; W5             1287         0         0             0</span></div></code></pre>
<p>we obtain the number of non-missing observations for each weather station and variable. Similarly, we can ask the number of non-missing observations for each date and variable using:</p>
<pre class="sourceCode r" id="cb8"><code class="sourceCode r"><div class="sourceLine" id="cb8-1" data-line-number="1">temporal_coverage &lt;-<span class="st"> </span><span class="kw">interpolation.coverage</span>(interpolator, <span class="dt">type =</span> <span class="st">'temporal'</span>)</div>
<div class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw">head</span>(temporal_coverage)</div>
<div class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt;            MinTemperature MaxTemperature Precipitation RelativeHumidity</span></div>
<div class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; 2000-01-01             13             13            14                6</span></div>
<div class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; 2000-01-02             13             13            14                6</span></div>
<div class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; 2000-01-03             13             13            14                6</span></div>
<div class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; 2000-01-04             13             13            14                6</span></div>
<div class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; 2000-01-05             13             13            14                6</span></div>
<div class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; 2000-01-06             13             13            14                6</span></div>
<div class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt;            Radiation WindSpeed WindDirection</span></div>
<div class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; 2000-01-01         0         0             0</span></div>
<div class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; 2000-01-02         0         0             0</span></div>
<div class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt; 2000-01-03         0         0             0</span></div>
<div class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt; 2000-01-04         0         0             0</span></div>
<div class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt; 2000-01-05         0         0             0</span></div>
<div class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt; 2000-01-06         0         0             0</span></div></code></pre>
<p>Interpolation parameters are also stored in the same object (see next subsection):</p>
<pre class="sourceCode r" id="cb9"><code class="sourceCode r"><div class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">names</span>(interpolator<span class="op">@</span>params)</div>
<div class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt;  [1] &quot;initial_Rp&quot;                &quot;iterations&quot;               </span></div>
<div class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt;  [3] &quot;alpha_MinTemperature&quot;      &quot;alpha_MaxTemperature&quot;     </span></div>
<div class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt;  [5] &quot;alpha_DewTemperature&quot;      &quot;alpha_PrecipitationEvent&quot; </span></div>
<div class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt;  [7] &quot;alpha_PrecipitationAmount&quot; &quot;alpha_Wind&quot;               </span></div>
<div class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt;  [9] &quot;N_MinTemperature&quot;          &quot;N_MaxTemperature&quot;         </span></div>
<div class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt; [11] &quot;N_DewTemperature&quot;          &quot;N_PrecipitationEvent&quot;     </span></div>
<div class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; [13] &quot;N_PrecipitationAmount&quot;     &quot;N_Wind&quot;                   </span></div>
<div class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt; [15] &quot;St_Precipitation&quot;          &quot;St_TemperatureRange&quot;      </span></div>
<div class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt; [17] &quot;pop_crit&quot;                  &quot;f_max&quot;                    </span></div>
<div class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt; [19] &quot;wind_height&quot;</span></div></code></pre>
</div>
<div id="interpolation-basics-and-parameters" class="section level2">
<h2>Interpolation basics and parameters</h2>
<p>Package meteoland implements, with a few modifications, the daily weather interpolation and estimation algorithms that un- derpin the U.S. <a href="https://daymet.ornl.gov/">DAYMET</a> dataset (Thornton et al., 1997; Thornton and Running, 1999).This approach, similar to inverse distance weighting, interpolates weather variables using trun- cated Gaussian filters, which consist in defining spatial weights <span class="math inline">\(W(r)\)</span> at radial distance <span class="math inline">\(r\)</span> from a target point <span class="math inline">\(p\)</span> using: <span class="math display">\[\begin{equation}
W(r) = e^{-\alpha \cdot (r/R_p)^2} - e^{-\alpha}
\end{equation}\]</span> if <span class="math inline">\(r \leq R_p\)</span> and <span class="math inline">\(W(r) = 0\)</span> otherwise.</p>
<p>Here <span class="math inline">\(r\)</span> is the radial distance from <span class="math inline">\(p\)</span>, <span class="math inline">\(R_p\)</span> is the truncation distance and <span class="math inline">\(\alpha\)</span> is the <strong>shape</strong> parameter. The spatial convolution of this filter with a set of weather station locations results, for each target point, in a vector of weights associated with observations. The following figure illustrates the Gaussian filter for <span class="math inline">\(R_p = 500\)</span> and either <span class="math inline">\(\alpha = 3.0\)</span> (continuous line) or <span class="math inline">\(\alpha = 6.25\)</span> (dashed line):</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(R_p\)</span> is automatically adjusted so that it has lower values in data-rich regions and is increased in data-poor regions. The method, however, requires the user to specify <span class="math inline">\(N\)</span>, the average number of observations to be included for each target point. <span class="math inline">\(R_p\)</span> is then varied as a smooth function of the local density in such a way that this average is achieved over the spatial domain. It is important that the initial value of <span class="math inline">\(R_p\)</span></p>
<p>In meteoland estimation of <span class="math inline">\(Rp\)</span> is done once for each target point, variable and day. Interpolation of temperature includes a correction for the effects of elevation. More specifically, a weighted least-squares regression is used to assess the relationship between temperature differences and elevation differences in weather station data and this relationship is applied to elevation differences between weather stations and the target point. Interpolation of relative humidity is done after transforming it to dew-point temperature. No correction for elevation is performed during interpolation, but elevation effects arise when back-transforming dew-point temperature to relative humidity. Interpolation of daily precipitation is complicated by the need to predict both precipitation occurrence and, conditioned on this, precipitation amount. Thornton et al. (1997) defined a binomial predictor of spatial precipitation occurrence as a function of the weighted occurrence at surrounding weather stations. Conditional on precipitation occurrence, the interpolation routine predicts precipitation amount, where weighted least-squares regression is also used to account for elevation effects. Interpolation of wind is performed in three different ways depending on the information available. If only wind speed data is available, the spatial interpolation with Gaussian weights is used on wind scalars as described above. If weather station data includes wind direction, a polar average is cal- culated using Gaussian weights. Finally, if static wind fields are also available the interpolation routine first finds, for each weather station the wind field that best matches the observed vector. Then, the wind vectors extracted from the selected wind fields are averaged as before. The details of how <span class="math inline">\(R_p\)</span> is estimated and, in general, how interpolation is done are given in a PDF vignette called ‘Meteorology’.</p>
<p>Interpolation parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(N\)</span> can be different for each variable to be interpolated. The following table lists all the interpolation parameters (see also function <code>defaultInterpolationParameters()</code>)</p>
<table style="width:85%;">
<colgroup>
<col width="19%"></col>
<col width="15%"></col>
<col width="50%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Paremeter</th>
<th>Default value</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>initial_Rp</code></td>
<td>140000</td>
<td>Initial truncation radius</td>
</tr>
<tr class="even">
<td><code>iterations</code></td>
<td>3</td>
<td>Number of station density iterations</td>
</tr>
<tr class="odd">
<td><code>alpha_MinTemperature</code></td>
<td>3.0</td>
<td>Gaussian shape parameter for minimum temperature</td>
</tr>
<tr class="even">
<td><code>alpha_MaxTemperature</code></td>
<td>3.0</td>
<td>Gaussian shape parameter for maximum temperature</td>
</tr>
<tr class="odd">
<td><code>alpha_DewTemperature</code></td>
<td>3.0</td>
<td>Gaussian shape parameter for dew-point temperature</td>
</tr>
<tr class="even">
<td><code>alpha_PrecipitationEvent</code></td>
<td>5.0</td>
<td>Gaussian shape parameter for precipitation events</td>
</tr>
<tr class="odd">
<td><code>alpha_PrecipitationAmount</code></td>
<td>5.0</td>
<td>Gaussian shape parameter for the regression of precipitation amounts</td>
</tr>
<tr class="even">
<td><code>alpha_Wind</code></td>
<td>3.0</td>
<td>Gaussian shape parameter for wind</td>
</tr>
<tr class="odd">
<td><code>N_MinTemperature</code></td>
<td>30</td>
<td>Average number of stations with non-zero weights for minimum temperature</td>
</tr>
<tr class="even">
<td><code>N_MaxTemperature</code></td>
<td>30</td>
<td>Average number of stations with non-zero weights for maximum temperature</td>
</tr>
<tr class="odd">
<td><code>N_DewTemperature</code></td>
<td>30</td>
<td>Average number of stations with non-zero weights for dew-point temperature</td>
</tr>
<tr class="even">
<td><code>N_PrecipitationEvent</code></td>
<td>5</td>
<td>Average number of stations with non-zero weights for precipitation events</td>
</tr>
<tr class="odd">
<td><code>N_PrecipitationAmount</code></td>
<td>20</td>
<td>Average number of stations with non-zero weights for the regression of precipitation amounts</td>
</tr>
<tr class="even">
<td><code>N_Wind</code></td>
<td>2</td>
<td>Average number of stations with non-zero weights for wind</td>
</tr>
<tr class="odd">
<td><code>St_Precipitation</code></td>
<td>5</td>
<td>Number of days for the temporal smoothing of precipitation</td>
</tr>
<tr class="even">
<td><code>St_TemperatureRange</code></td>
<td>15</td>
<td>Number of days for the temporal smoothing of temperature range</td>
</tr>
<tr class="odd">
<td><code>pop_crit</code></td>
<td>0.50</td>
<td>Critical precipitation occurrence parameter</td>
</tr>
<tr class="even">
<td><code>f_max</code></td>
<td>0.6</td>
<td>Maximum value for precipitation regression extrapolations (0.6 equals to a maximum of 4 times extrapolation)</td>
</tr>
<tr class="odd">
<td><code>wind_height</code></td>
<td>10</td>
<td>Wind measurement height (in m)</td>
</tr>
</tbody>
</table>
<p>Parameter <code>St_Precipitation</code> controls the temporal smoothing that is applied to weather station data to calibrate regression, while parameters <code>pop_crit</code> and <code>f_max</code> are also particular to the estimation of precipitation (see details in Thornton et al. 1997). Parameter <code>St_TemperatureRange</code> is used for the estimation of solar radiation (see details in PDF vignette called ‘Meteorology’).</p>
<p>A parameter that is particularly important to understand is <code>initial_Rp</code>, which specifies the initial radius for the truncated spatial Gaussian kernel. By default its value is:</p>
<pre class="sourceCode r" id="cb10"><code class="sourceCode r"><div class="sourceLine" id="cb10-1" data-line-number="1">interpolator<span class="op">@</span>params<span class="op">$</span>initial_Rp</div>
<div class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt; [1] 25329.88</span></div></code></pre>
<p>The value of <code>initial_Rp</code> must be set in relation to the units of the spatial coordinates of weather data. Our data was in meters, so the default radius is 140 km. In general, the initial radius should be large enough to include a reasonable number of stations (~20-40), but the kernel radius is adjusted for each interpolation target point.</p>
</div>
<div id="calibration-and-cross-validation-of-the-interpolation-data" class="section level2">
<h2>Calibration and cross-validation of the interpolation data</h2>
<p>Once we already have weather stations data in shape, we can start calibrating the model in order to obtain the optimal parameters for the meteorological variables we want to interpolate. Parameter calibration has to be done for each variable separately. For example for minimum temperature:</p>
<pre class="sourceCode r" id="cb11"><code class="sourceCode r"><div class="sourceLine" id="cb11-1" data-line-number="1">tmin_cal &lt;-<span class="st"> </span><span class="kw">interpolation.calibration</span>(interpolator, <span class="dt">variable =</span> <span class="st">&quot;Tmin&quot;</span>,</div>
<div class="sourceLine" id="cb11-2" data-line-number="2">                                      <span class="dt">N_seq =</span> <span class="dv">20</span>,</div>
<div class="sourceLine" id="cb11-3" data-line-number="3">                                      <span class="dt">alpha_seq =</span> <span class="kw">seq</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">1</span>),</div>
<div class="sourceLine" id="cb11-4" data-line-number="4">                                      <span class="dt">verbose =</span> <span class="ot">TRUE</span>)</div>
<div class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt; Total number of stations: 38</span></div>
<div class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt; Number of stations with available data: 15</span></div>
<div class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; Number of stations used for MAE: 15</span></div>
<div class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt; Number of parameter combinations to test: 6</span></div>
<div class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt; </span></div>
<div class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt; Evaluation of parameter combinations...</span></div>
<div class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt;    N: 20 alpha: 5 MAE = 1.18623508801814</span></div>
<div class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt;    N: 20 alpha: 6 MAE = 1.18416517354223</span></div>
<div class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt;    N: 20 alpha: 7 MAE = 1.18359260839307</span></div>
<div class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">#&gt;    N: 20 alpha: 8 MAE = 1.18303735002687</span></div>
<div class="sourceLine" id="cb11-15" data-line-number="15"><span class="co">#&gt;    N: 20 alpha: 9 MAE = 1.18191979076192</span></div>
<div class="sourceLine" id="cb11-16" data-line-number="16"><span class="co">#&gt;    N: 20 alpha: 10 MAE = 1.18082343660302</span></div>
<div class="sourceLine" id="cb11-17" data-line-number="17"><span class="co">#&gt; </span></div>
<div class="sourceLine" id="cb11-18" data-line-number="18"><span class="co">#&gt; Minimum MAE value: 1.18082343660302 N: 20 alpha: 10</span></div></code></pre>
<p>This function returns an interpolation.calibration class object which contains several items:</p>
<ul>
<li>Numeric matrix with the mean absolute error (MAE) values for each combination of parameters <span class="math inline">\(N\)</span> and <span class="math inline">\(\alpha\)</span>.</li>
<li>Miminum value found for MAE.</li>
<li>Value for the <span class="math inline">\(N\)</span> parameter corresponding to the minumun MAE.</li>
<li>Value for the <span class="math inline">\(\alpha\)</span> parameter corresponding to the minimum MAE.</li>
<li>Matrix with the observed values.</li>
<li>Matrix with the predicted values for the optimum parameter combination.</li>
</ul>
<p>The result of the calibration needs to be manually stored in the interpolation params:</p>
<pre class="sourceCode r" id="cb12"><code class="sourceCode r"><div class="sourceLine" id="cb12-1" data-line-number="1">interpolator<span class="op">@</span>params<span class="op">$</span>N_MinTemperature =<span class="st"> </span>tmin_cal<span class="op">$</span>N</div>
<div class="sourceLine" id="cb12-2" data-line-number="2">interpolator<span class="op">@</span>params<span class="op">$</span>alpha_MinTemperature =<span class="st"> </span>tmin_cal<span class="op">$</span>alpha</div></code></pre>
<p>We strongly recommend conducting calibration exercises at least once for each variable and each data set used as reference for interpolation, and more than once if periods differ in the number of stations available.</p>
<p>Before using the object for interpolations, we also need to assess its performance. This is done by cross-validation in function <code>interpolation.cv</code>:</p>
<pre><code>#&gt; Station #1 C7
#&gt; Station #2 C8
#&gt; Station #3 CA
#&gt; Station #4 VD
#&gt; Station #5 VP
#&gt; Station #6 W5
#&gt; Station #7 WA
#&gt; Station #8 XT: No observations.
#&gt; Station #9 9713
#&gt; Station #10 9713A: No observations.
#&gt; Station #11 9650X: No observations.
#&gt; Station #12 0166: No observations.
#&gt; Station #13 9717
#&gt; Station #14 9717A
#&gt; Station #15 9718C
#&gt; Station #16 9712N: No observations.
#&gt; Station #17 9712O
#&gt; Station #18 9720N: No observations.
#&gt; Station #19 9638E: No observations.
#&gt; Station #20 9638: No observations.
#&gt; Station #21 0130: No observations.
#&gt; Station #22 9640: No observations.
#&gt; Station #23 9649
#&gt; Station #24 9649A: No observations.
#&gt; Station #25 0133: No observations.
#&gt; Station #26 0132: No observations.
#&gt; Station #27 0131U
#&gt; Station #28 9720X
#&gt; Station #29 9720: No observations.
#&gt; Station #30 9720A
#&gt; Station #31 9647X: No observations.
#&gt; Station #32 9718X: No observations.
#&gt; Station #33 0166I: No observations.
#&gt; Station #34 9648: No observations.
#&gt; Station #35 9644: No observations.
#&gt; Station #36 9645: No observations.
#&gt; Station #37 9712: No observations.
#&gt; Station #38 9712E: No observations.</code></pre>
<p>Cross-validation is perfomed by <em>leave-one-out</em>, which means that each target station is first removed from the data set and then the remaining stations are used to obtain interpolation estimates. In this way one maximizes the amount of information for estimates, while keeping them independent of the observed values in each station. The results of cross-validation can be inspected using a specific <code>summary</code> function:</p>
<pre class="sourceCode r" id="cb14"><code class="sourceCode r"><div class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">summary</span>(cv)</div>
<div class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#&gt;                                n          r         MAE sd.station.MAE</span></div>
<div class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">#&gt; MinTemperature             20618  0.9711987   1.1808234      0.4504965</span></div>
<div class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#&gt; MaxTemperature             20616  0.9848303   1.0813712      0.5078724</span></div>
<div class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt; TemperatureRange           20612  0.8486540   1.6104133      0.6126532</span></div>
<div class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; RelativeHumidity           10148  0.8835544   6.0612124      2.8747524</span></div>
<div class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt; Radiation                      0         NA         NaN             NA</span></div>
<div class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt; Station.rainfall              16  0.8714303 149.3438156    133.4677792</span></div>
<div class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt; Station.rainfall.relative     16         NA   8.9551880      9.3741873</span></div>
<div class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt; Station.precdays              16 -0.2911044 100.1875000     94.5686479</span></div>
<div class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#&gt; Station.precdays.relative     16         NA  29.7535299     29.4253402</span></div>
<div class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#&gt; Date.rainfall                728  0.9913120   4.7063335             NA</span></div>
<div class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#&gt; Date.rainfall.relative       728         NA  26.4131863             NA</span></div>
<div class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt; Date.precstations            728  0.9783504   0.8502747             NA</span></div>
<div class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">#&gt; Date.precstations.relative   728         NA  20.7017971             NA</span></div>
<div class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">#&gt;                            sd.dates.MAE         Bias sd.station.Bias</span></div>
<div class="sourceLine" id="cb14-17" data-line-number="17"><span class="co">#&gt; MinTemperature                0.4370359   0.24744730       0.8188687</span></div>
<div class="sourceLine" id="cb14-18" data-line-number="18"><span class="co">#&gt; MaxTemperature                0.4456374  -0.00178348       0.7216981</span></div>
<div class="sourceLine" id="cb14-19" data-line-number="19"><span class="co">#&gt; TemperatureRange              0.5369418  -0.24924824       1.1273182</span></div>
<div class="sourceLine" id="cb14-20" data-line-number="20"><span class="co">#&gt; RelativeHumidity              1.9722776  -1.07555036       5.4647617</span></div>
<div class="sourceLine" id="cb14-21" data-line-number="21"><span class="co">#&gt; Radiation                            NA          NaN              NA</span></div>
<div class="sourceLine" id="cb14-22" data-line-number="22"><span class="co">#&gt; Station.rainfall                     NA -66.05159025     192.2250286</span></div>
<div class="sourceLine" id="cb14-23" data-line-number="23"><span class="co">#&gt; Station.rainfall.relative            NA  -2.09791005      12.9893224</span></div>
<div class="sourceLine" id="cb14-24" data-line-number="24"><span class="co">#&gt; Station.precdays                     NA -31.06250000     136.4577926</span></div>
<div class="sourceLine" id="cb14-25" data-line-number="25"><span class="co">#&gt; Station.precdays.relative            NA  -0.64453281      42.5405481</span></div>
<div class="sourceLine" id="cb14-26" data-line-number="26"><span class="co">#&gt; Date.rainfall                 8.1532830  -1.16157341              NA</span></div>
<div class="sourceLine" id="cb14-27" data-line-number="27"><span class="co">#&gt; Date.rainfall.relative       23.7087247 -14.29115571              NA</span></div>
<div class="sourceLine" id="cb14-28" data-line-number="28"><span class="co">#&gt; Date.precstations             0.8655726  -0.38049451              NA</span></div>
<div class="sourceLine" id="cb14-29" data-line-number="29"><span class="co">#&gt; Date.precstations.relative   23.7243708 -12.47190577              NA</span></div>
<div class="sourceLine" id="cb14-30" data-line-number="30"><span class="co">#&gt;                            sd.dates.Bias</span></div>
<div class="sourceLine" id="cb14-31" data-line-number="31"><span class="co">#&gt; MinTemperature                 0.2263925</span></div>
<div class="sourceLine" id="cb14-32" data-line-number="32"><span class="co">#&gt; MaxTemperature                 0.1699181</span></div>
<div class="sourceLine" id="cb14-33" data-line-number="33"><span class="co">#&gt; TemperatureRange               0.2795973</span></div>
<div class="sourceLine" id="cb14-34" data-line-number="34"><span class="co">#&gt; RelativeHumidity               2.0962431</span></div>
<div class="sourceLine" id="cb14-35" data-line-number="35"><span class="co">#&gt; Radiation                             NA</span></div>
<div class="sourceLine" id="cb14-36" data-line-number="36"><span class="co">#&gt; Station.rainfall                      NA</span></div>
<div class="sourceLine" id="cb14-37" data-line-number="37"><span class="co">#&gt; Station.rainfall.relative             NA</span></div>
<div class="sourceLine" id="cb14-38" data-line-number="38"><span class="co">#&gt; Station.precdays                      NA</span></div>
<div class="sourceLine" id="cb14-39" data-line-number="39"><span class="co">#&gt; Station.precdays.relative             NA</span></div>
<div class="sourceLine" id="cb14-40" data-line-number="40"><span class="co">#&gt; Date.rainfall                  9.3437122</span></div>
<div class="sourceLine" id="cb14-41" data-line-number="41"><span class="co">#&gt; Date.rainfall.relative        32.4992556</span></div>
<div class="sourceLine" id="cb14-42" data-line-number="42"><span class="co">#&gt; Date.precstations              1.1524766</span></div>
<div class="sourceLine" id="cb14-43" data-line-number="43"><span class="co">#&gt; Date.precstations.relative    28.9177675</span></div></code></pre>
</div>
<div id="interpolation-on-a-grid" class="section level2">
<h2>Interpolation on a grid</h2>
<p>The target for weather interpolation in <code>meteoland</code> can be a set of points, pixels or a whole grid. Again, the initial format of data can be very different. Here we assume you have a small grid of 400 (20x20) cells of 1ha in size, with elevation data in form of class <code>SpatialGridDataFrame</code> (see method <code>read.asciigrid</code> in package <em>sp</em>):</p>
<pre class="sourceCode r" id="cb15"><code class="sourceCode r"><div class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">summary</span>(elev)</div>
<div class="sourceLine" id="cb15-2" data-line-number="2"><span class="co">#&gt; Object of class SpatialGridDataFrame</span></div>
<div class="sourceLine" id="cb15-3" data-line-number="3"><span class="co">#&gt; Coordinates:</span></div>
<div class="sourceLine" id="cb15-4" data-line-number="4"><span class="co">#&gt;        min     max</span></div>
<div class="sourceLine" id="cb15-5" data-line-number="5"><span class="co">#&gt; s1  359950  361950</span></div>
<div class="sourceLine" id="cb15-6" data-line-number="6"><span class="co">#&gt; s2 4638950 4640950</span></div>
<div class="sourceLine" id="cb15-7" data-line-number="7"><span class="co">#&gt; Is projected: TRUE </span></div>
<div class="sourceLine" id="cb15-8" data-line-number="8"><span class="co">#&gt; proj4string :</span></div>
<div class="sourceLine" id="cb15-9" data-line-number="9"><span class="co">#&gt; [+proj=utm +zone=31 +ellps=WGS84 +datum=WGS84 +units=m</span></div>
<div class="sourceLine" id="cb15-10" data-line-number="10"><span class="co">#&gt; +towgs84=0,0,0]</span></div>
<div class="sourceLine" id="cb15-11" data-line-number="11"><span class="co">#&gt; Grid attributes:</span></div>
<div class="sourceLine" id="cb15-12" data-line-number="12"><span class="co">#&gt;    cellcentre.offset cellsize cells.dim</span></div>
<div class="sourceLine" id="cb15-13" data-line-number="13"><span class="co">#&gt; s1            360000      100        20</span></div>
<div class="sourceLine" id="cb15-14" data-line-number="14"><span class="co">#&gt; s2           4639000      100        20</span></div>
<div class="sourceLine" id="cb15-15" data-line-number="15"><span class="co">#&gt; Data attributes:</span></div>
<div class="sourceLine" id="cb15-16" data-line-number="16"><span class="co">#&gt;    elevation    </span></div>
<div class="sourceLine" id="cb15-17" data-line-number="17"><span class="co">#&gt;  Min.   :418.0  </span></div>
<div class="sourceLine" id="cb15-18" data-line-number="18"><span class="co">#&gt;  1st Qu.:484.0  </span></div>
<div class="sourceLine" id="cb15-19" data-line-number="19"><span class="co">#&gt;  Median :518.0  </span></div>
<div class="sourceLine" id="cb15-20" data-line-number="20"><span class="co">#&gt;  Mean   :511.3  </span></div>
<div class="sourceLine" id="cb15-21" data-line-number="21"><span class="co">#&gt;  3rd Qu.:539.0  </span></div>
<div class="sourceLine" id="cb15-22" data-line-number="22"><span class="co">#&gt;  Max.   :601.0</span></div></code></pre>
<p>Note that the coordinate reference system needs to be the same as that of <code>interpolator</code>, which in this case it is. Before performing the interpolation over this grid, we need to reshape this data in a class called <code>SpatialGridTopography</code>:</p>
<pre class="sourceCode r" id="cb16"><code class="sourceCode r"><div class="sourceLine" id="cb16-1" data-line-number="1">sgt =<span class="st"> </span><span class="kw">SpatialGridTopography</span>(<span class="kw">as</span>(elev, <span class="st">&quot;SpatialGrid&quot;</span>), <span class="dt">elevation =</span> elev<span class="op">$</span>elevation,</div>
<div class="sourceLine" id="cb16-2" data-line-number="2">                            <span class="dt">proj4string =</span> elev<span class="op">@</span>proj4string)</div>
<div class="sourceLine" id="cb16-3" data-line-number="3">sgt</div>
<div class="sourceLine" id="cb16-4" data-line-number="4"><span class="co">#&gt; Object of class SpatialGridTopography</span></div>
<div class="sourceLine" id="cb16-5" data-line-number="5"><span class="co">#&gt; Grid topology:</span></div>
<div class="sourceLine" id="cb16-6" data-line-number="6"><span class="co">#&gt;    cellcentre.offset cellsize cells.dim</span></div>
<div class="sourceLine" id="cb16-7" data-line-number="7"><span class="co">#&gt; s1            360000      100        20</span></div>
<div class="sourceLine" id="cb16-8" data-line-number="8"><span class="co">#&gt; s2           4639000      100        20</span></div>
<div class="sourceLine" id="cb16-9" data-line-number="9"><span class="co">#&gt; Coordinate Reference System (CRS) arguments: +proj=utm +zone=31</span></div>
<div class="sourceLine" id="cb16-10" data-line-number="10"><span class="co">#&gt; +ellps=WGS84 +datum=WGS84 +units=m +towgs84=0,0,0 </span></div>
<div class="sourceLine" id="cb16-11" data-line-number="11"><span class="co">#&gt; </span></div>
<div class="sourceLine" id="cb16-12" data-line-number="12"><span class="co">#&gt; Topography summary:</span></div>
<div class="sourceLine" id="cb16-13" data-line-number="13"><span class="co">#&gt;    elevation         slope             aspect        </span></div>
<div class="sourceLine" id="cb16-14" data-line-number="14"><span class="co">#&gt;  Min.   :418.0   Min.   : 0.2265   Min.   :  0.9392  </span></div>
<div class="sourceLine" id="cb16-15" data-line-number="15"><span class="co">#&gt;  1st Qu.:484.0   1st Qu.: 5.7382   1st Qu.:100.8848  </span></div>
<div class="sourceLine" id="cb16-16" data-line-number="16"><span class="co">#&gt;  Median :518.0   Median : 8.8257   Median :156.2479  </span></div>
<div class="sourceLine" id="cb16-17" data-line-number="17"><span class="co">#&gt;  Mean   :511.3   Mean   : 9.4178   Mean   :172.7948  </span></div>
<div class="sourceLine" id="cb16-18" data-line-number="18"><span class="co">#&gt;  3rd Qu.:539.0   3rd Qu.:13.1438   3rd Qu.:242.3809  </span></div>
<div class="sourceLine" id="cb16-19" data-line-number="19"><span class="co">#&gt;  Max.   :601.0   Max.   :23.2798   Max.   :347.0054</span></div></code></pre>
<p>As you can see in the result, <code>meteoland</code> has calculated for us slope and aspect (both in degrees) from elevation data <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. Slope and aspect are important for radiation calculations, which also requires relative humidity data. We can display elevation over the grid using:</p>
<pre class="sourceCode r" id="cb17"><code class="sourceCode r"><div class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">spplot</span>(sgt, <span class="st">&quot;elevation&quot;</span>)</div></code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Before we call the interpolation routine, we need to define the dates (i.e. days) for which we want weather to be interpolated, for example:</p>
<pre class="sourceCode r" id="cb18"><code class="sourceCode r"><div class="sourceLine" id="cb18-1" data-line-number="1">dates =<span class="st"> </span><span class="kw">as.Date</span>(<span class="kw">c</span>(<span class="st">&quot;2001-02-03&quot;</span>, <span class="st">&quot;2001-06-03&quot;</span>))</div></code></pre>
<p>Of course, we need to be sure that the <code>interpolator</code> object has data corresponding to this dates. We can check if there is any missing date using:</p>
<pre class="sourceCode r" id="cb19"><code class="sourceCode r"><div class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">sum</span>(<span class="op">!</span>(dates <span class="op">%in%</span><span class="st"> </span>interpolator<span class="op">@</span>dates))</div>
<div class="sourceLine" id="cb19-2" data-line-number="2"><span class="co">#&gt; [1] 0</span></div></code></pre>
<p>The name of interpolation functions depend on the target spatial structure. For grids we need to use function <code>interpolationgrid</code>:</p>
<pre class="sourceCode r" id="cb20"><code class="sourceCode r"><div class="sourceLine" id="cb20-1" data-line-number="1">ml &lt;-<span class="st"> </span><span class="kw">interpolationgrid</span>(interpolator, sgt, dates)</div>
<div class="sourceLine" id="cb20-2" data-line-number="2"><span class="co">#&gt; Date 2001-02-03 (1/2) - done.</span></div>
<div class="sourceLine" id="cb20-3" data-line-number="3"><span class="co">#&gt; Date 2001-06-03 (2/2) - done.</span></div></code></pre>
<p>This function works processing each date at a time. Since calculations can take some time, the console output shows the progress. The output of the function is an object of class <code>SpatialGridMeteorology</code>:</p>
<pre class="sourceCode r" id="cb21"><code class="sourceCode r"><div class="sourceLine" id="cb21-1" data-line-number="1">ml</div>
<div class="sourceLine" id="cb21-2" data-line-number="2"><span class="co">#&gt; Object of class SpatialGridMeteorology</span></div>
<div class="sourceLine" id="cb21-3" data-line-number="3"><span class="co">#&gt; Dates:  2  (initial: 2001-02-03 final: 2001-06-03)</span></div>
<div class="sourceLine" id="cb21-4" data-line-number="4"><span class="co">#&gt; Grid topology:</span></div>
<div class="sourceLine" id="cb21-5" data-line-number="5"><span class="co">#&gt;    cellcentre.offset cellsize cells.dim</span></div>
<div class="sourceLine" id="cb21-6" data-line-number="6"><span class="co">#&gt; s1            360000      100        20</span></div>
<div class="sourceLine" id="cb21-7" data-line-number="7"><span class="co">#&gt; s2           4639000      100        20</span></div>
<div class="sourceLine" id="cb21-8" data-line-number="8"><span class="co">#&gt; Coordinate Reference System (CRS) arguments: +proj=utm +zone=31</span></div>
<div class="sourceLine" id="cb21-9" data-line-number="9"><span class="co">#&gt; +ellps=WGS84 +datum=WGS84 +units=m +towgs84=0,0,0</span></div></code></pre>
<p>We can display interpolated grids in a map using function <code>spplot</code>:</p>
<pre class="sourceCode r" id="cb22"><code class="sourceCode r"><div class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">spplot</span>(ml, <span class="dv">2</span>, <span class="st">&quot;MinTemperature&quot;</span>)</div>
<div class="sourceLine" id="cb22-2" data-line-number="2"><span class="kw">spplot</span>(ml, <span class="dv">2</span>, <span class="st">&quot;MaxTemperature&quot;</span>)</div></code></pre>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
<p>Objects of class <code>SpatialGridMeteorology</code> include a list of data frames, one per date. We can access the interpolated data for a given date using:</p>
<pre class="sourceCode r" id="cb23"><code class="sourceCode r"><div class="sourceLine" id="cb23-1" data-line-number="1">df_<span class="dv">1</span> =<span class="st"> </span>ml<span class="op">@</span>data[[<span class="dv">1</span>]]</div>
<div class="sourceLine" id="cb23-2" data-line-number="2"><span class="kw">head</span>(df_<span class="dv">1</span>)</div>
<div class="sourceLine" id="cb23-3" data-line-number="3"><span class="co">#&gt;   MeanTemperature MinTemperature MaxTemperature Precipitation</span></div>
<div class="sourceLine" id="cb23-4" data-line-number="4"><span class="co">#&gt; 1        6.727439      -1.307918       11.95175             0</span></div>
<div class="sourceLine" id="cb23-5" data-line-number="5"><span class="co">#&gt; 2        6.758216      -1.251034       11.96555             0</span></div>
<div class="sourceLine" id="cb23-6" data-line-number="6"><span class="co">#&gt; 3        6.820188      -1.136355       11.99325             0</span></div>
<div class="sourceLine" id="cb23-7" data-line-number="7"><span class="co">#&gt; 4        6.804245      -1.166117       11.98630             0</span></div>
<div class="sourceLine" id="cb23-8" data-line-number="8"><span class="co">#&gt; 5        6.881788      -1.022737       12.02103             0</span></div>
<div class="sourceLine" id="cb23-9" data-line-number="9"><span class="co">#&gt; 6        6.762238      -1.244088       11.96767             0</span></div>
<div class="sourceLine" id="cb23-10" data-line-number="10"><span class="co">#&gt;   MeanRelativeHumidity MinRelativeHumidity MaxRelativeHumidity Radiation</span></div>
<div class="sourceLine" id="cb23-11" data-line-number="11"><span class="co">#&gt; 1             93.24990            65.58217                 100  10.29353</span></div>
<div class="sourceLine" id="cb23-12" data-line-number="12"><span class="co">#&gt; 2             93.05261            65.52248                 100  10.91566</span></div>
<div class="sourceLine" id="cb23-13" data-line-number="13"><span class="co">#&gt; 3             92.65679            65.40286                 100  12.01522</span></div>
<div class="sourceLine" id="cb23-14" data-line-number="14"><span class="co">#&gt; 4             92.75840            65.43285                 100  11.17310</span></div>
<div class="sourceLine" id="cb23-15" data-line-number="15"><span class="co">#&gt; 5             92.26518            65.28313                 100  12.28508</span></div>
<div class="sourceLine" id="cb23-16" data-line-number="16"><span class="co">#&gt; 6             93.02674            65.51322                 100  10.90505</span></div>
<div class="sourceLine" id="cb23-17" data-line-number="17"><span class="co">#&gt;   WindSpeed WindDirection      PET</span></div>
<div class="sourceLine" id="cb23-18" data-line-number="18"><span class="co">#&gt; 1        NA            NA 1.333524</span></div>
<div class="sourceLine" id="cb23-19" data-line-number="19"><span class="co">#&gt; 2        NA            NA 1.449239</span></div>
<div class="sourceLine" id="cb23-20" data-line-number="20"><span class="co">#&gt; 3        NA            NA 1.655191</span></div>
<div class="sourceLine" id="cb23-21" data-line-number="21"><span class="co">#&gt; 4        NA            NA 1.500705</span></div>
<div class="sourceLine" id="cb23-22" data-line-number="22"><span class="co">#&gt; 5        NA            NA 1.711103</span></div>
<div class="sourceLine" id="cb23-23" data-line-number="23"><span class="co">#&gt; 6        NA            NA 1.447961</span></div></code></pre>
<p>Some columns are missing (e.g. wind speed) because we did not include weather station data regarding these variables. If we wants to add grid coordinates to this data frame, we can use the spatial information stored in the <code>ml</code> object:</p>
<pre class="sourceCode r" id="cb24"><code class="sourceCode r"><div class="sourceLine" id="cb24-1" data-line-number="1">sgdf_<span class="dv">1</span> =<span class="st"> </span><span class="kw">SpatialGridDataFrame</span>(<span class="dt">grid =</span> ml<span class="op">@</span>grid, <span class="dt">data =</span> ml<span class="op">@</span>data[[<span class="dv">1</span>]], <span class="dt">proj4string =</span> ml<span class="op">@</span>proj4string)</div>
<div class="sourceLine" id="cb24-2" data-line-number="2"><span class="kw">summary</span>(sgdf_<span class="dv">1</span>)</div>
<div class="sourceLine" id="cb24-3" data-line-number="3"><span class="co">#&gt; Object of class SpatialGridDataFrame</span></div>
<div class="sourceLine" id="cb24-4" data-line-number="4"><span class="co">#&gt; Coordinates:</span></div>
<div class="sourceLine" id="cb24-5" data-line-number="5"><span class="co">#&gt;        min     max</span></div>
<div class="sourceLine" id="cb24-6" data-line-number="6"><span class="co">#&gt; s1  359950  361950</span></div>
<div class="sourceLine" id="cb24-7" data-line-number="7"><span class="co">#&gt; s2 4638950 4640950</span></div>
<div class="sourceLine" id="cb24-8" data-line-number="8"><span class="co">#&gt; Is projected: TRUE </span></div>
<div class="sourceLine" id="cb24-9" data-line-number="9"><span class="co">#&gt; proj4string :</span></div>
<div class="sourceLine" id="cb24-10" data-line-number="10"><span class="co">#&gt; [+proj=utm +zone=31 +ellps=WGS84 +datum=WGS84 +units=m</span></div>
<div class="sourceLine" id="cb24-11" data-line-number="11"><span class="co">#&gt; +towgs84=0,0,0]</span></div>
<div class="sourceLine" id="cb24-12" data-line-number="12"><span class="co">#&gt; Grid attributes:</span></div>
<div class="sourceLine" id="cb24-13" data-line-number="13"><span class="co">#&gt;    cellcentre.offset cellsize cells.dim</span></div>
<div class="sourceLine" id="cb24-14" data-line-number="14"><span class="co">#&gt; s1            360000      100        20</span></div>
<div class="sourceLine" id="cb24-15" data-line-number="15"><span class="co">#&gt; s2           4639000      100        20</span></div>
<div class="sourceLine" id="cb24-16" data-line-number="16"><span class="co">#&gt; Data attributes:</span></div>
<div class="sourceLine" id="cb24-17" data-line-number="17"><span class="co">#&gt;  MeanTemperature MinTemperature    MaxTemperature  Precipitation</span></div>
<div class="sourceLine" id="cb24-18" data-line-number="18"><span class="co">#&gt;  Min.   :6.154   Min.   :-2.3017   Min.   :11.64   Min.   :0    </span></div>
<div class="sourceLine" id="cb24-19" data-line-number="19"><span class="co">#&gt;  1st Qu.:6.472   1st Qu.:-1.7266   1st Qu.:11.80   1st Qu.:0    </span></div>
<div class="sourceLine" id="cb24-20" data-line-number="20"><span class="co">#&gt;  Median :6.611   Median :-1.4829   Median :11.88   Median :0    </span></div>
<div class="sourceLine" id="cb24-21" data-line-number="21"><span class="co">#&gt;  Mean   :6.591   Mean   :-1.5153   Mean   :11.86   Mean   :0    </span></div>
<div class="sourceLine" id="cb24-22" data-line-number="22"><span class="co">#&gt;  3rd Qu.:6.727   3rd Qu.:-1.2705   3rd Qu.:11.93   3rd Qu.:0    </span></div>
<div class="sourceLine" id="cb24-23" data-line-number="23"><span class="co">#&gt;  Max.   :7.028   Max.   :-0.7301   Max.   :12.07   Max.   :0    </span></div>
<div class="sourceLine" id="cb24-24" data-line-number="24"><span class="co">#&gt;                                                                 </span></div>
<div class="sourceLine" id="cb24-25" data-line-number="25"><span class="co">#&gt;  MeanRelativeHumidity MinRelativeHumidity MaxRelativeHumidity</span></div>
<div class="sourceLine" id="cb24-26" data-line-number="26"><span class="co">#&gt;  Min.   :91.34        Min.   :65.06       Min.   :100        </span></div>
<div class="sourceLine" id="cb24-27" data-line-number="27"><span class="co">#&gt;  1st Qu.:93.25        1st Qu.:65.68       1st Qu.:100        </span></div>
<div class="sourceLine" id="cb24-28" data-line-number="28"><span class="co">#&gt;  Median :94.00        Median :65.91       Median :100        </span></div>
<div class="sourceLine" id="cb24-29" data-line-number="29"><span class="co">#&gt;  Mean   :94.14        Mean   :65.97       Mean   :100        </span></div>
<div class="sourceLine" id="cb24-30" data-line-number="30"><span class="co">#&gt;  3rd Qu.:94.91        3rd Qu.:66.25       3rd Qu.:100        </span></div>
<div class="sourceLine" id="cb24-31" data-line-number="31"><span class="co">#&gt;  Max.   :97.02        Max.   :66.93       Max.   :100        </span></div>
<div class="sourceLine" id="cb24-32" data-line-number="32"><span class="co">#&gt;                                                              </span></div>
<div class="sourceLine" id="cb24-33" data-line-number="33"><span class="co">#&gt;    Radiation        WindSpeed   WindDirection      PET        </span></div>
<div class="sourceLine" id="cb24-34" data-line-number="34"><span class="co">#&gt;  Min.   : 4.477   Min.   : NA   Min.   : NA   Min.   :0.2687  </span></div>
<div class="sourceLine" id="cb24-35" data-line-number="35"><span class="co">#&gt;  1st Qu.: 9.571   1st Qu.: NA   1st Qu.: NA   1st Qu.:1.1894  </span></div>
<div class="sourceLine" id="cb24-36" data-line-number="36"><span class="co">#&gt;  Median :10.953   Median : NA   Median : NA   Median :1.4463  </span></div>
<div class="sourceLine" id="cb24-37" data-line-number="37"><span class="co">#&gt;  Mean   :10.949   Mean   :NaN   Mean   :NaN   Mean   :1.4395  </span></div>
<div class="sourceLine" id="cb24-38" data-line-number="38"><span class="co">#&gt;  3rd Qu.:12.276   3rd Qu.: NA   3rd Qu.: NA   3rd Qu.:1.6882  </span></div>
<div class="sourceLine" id="cb24-39" data-line-number="39"><span class="co">#&gt;  Max.   :16.238   Max.   : NA   Max.   : NA   Max.   :2.3694  </span></div>
<div class="sourceLine" id="cb24-40" data-line-number="40"><span class="co">#&gt;                   NA's   :400   NA's   :400</span></div></code></pre>
<p>Results can be retrieved in this way and saved using <code>write.asciigrid</code> for its use outside R. The package also provides function for reading/writing NetCDFs (see function <code>writemeteorologygrid</code>) from <code>SpatialGridMeteorology</code> objects.</p>
</div>
<div id="interpolation-on-a-set-of-points" class="section level2">
<h2>Interpolation on a set of points</h2>
<p>If you want to interpolate on a set of target locations, the starting point will normally be a <code>data.frame</code>. In our example this points come from the grid, but we have reshaped them so the starting format is familiar:</p>
<pre class="sourceCode r" id="cb25"><code class="sourceCode r"><div class="sourceLine" id="cb25-1" data-line-number="1">points_df</div>
<div class="sourceLine" id="cb25-2" data-line-number="2"><span class="co">#&gt;    X_UTM   Y_UTM elevation</span></div>
<div class="sourceLine" id="cb25-3" data-line-number="3"><span class="co">#&gt; 1 363500 4640900       524</span></div>
<div class="sourceLine" id="cb25-4" data-line-number="4"><span class="co">#&gt; 2 362700 4640700       509</span></div>
<div class="sourceLine" id="cb25-5" data-line-number="5"><span class="co">#&gt; 3 362900 4640400       544</span></div>
<div class="sourceLine" id="cb25-6" data-line-number="6"><span class="co">#&gt; 4 360300 4638600       425</span></div></code></pre>
<p>Analogously with the grid, we need to transform this data into an object <code>SpatialPointsTopography</code>:</p>
<pre class="sourceCode r" id="cb26"><code class="sourceCode r"><div class="sourceLine" id="cb26-1" data-line-number="1">spt =<span class="st"> </span><span class="kw">SpatialPointsTopography</span>(<span class="kw">as.matrix</span>(points_df[,<span class="kw">c</span>(<span class="st">&quot;X_UTM&quot;</span>, <span class="st">&quot;Y_UTM&quot;</span>)]),</div>
<div class="sourceLine" id="cb26-2" data-line-number="2">                              <span class="dt">elevation =</span> points_df<span class="op">$</span>elevation,</div>
<div class="sourceLine" id="cb26-3" data-line-number="3">                              <span class="dt">proj4string =</span> <span class="kw">CRS</span>(<span class="st">&quot;+proj=utm +zone=31 +ellps=WGS84 +datum=WGS84 +units=m +towgs84=0,0,0&quot;</span>))</div>
<div class="sourceLine" id="cb26-4" data-line-number="4">spt</div>
<div class="sourceLine" id="cb26-5" data-line-number="5"><span class="co">#&gt; Object of class SpatialPointsTopography</span></div>
<div class="sourceLine" id="cb26-6" data-line-number="6"><span class="co">#&gt;         coordinates elevation slope aspect</span></div>
<div class="sourceLine" id="cb26-7" data-line-number="7"><span class="co">#&gt; 1 (363500, 4640900)       524    NA     NA</span></div>
<div class="sourceLine" id="cb26-8" data-line-number="8"><span class="co">#&gt; 2 (362700, 4640700)       509    NA     NA</span></div>
<div class="sourceLine" id="cb26-9" data-line-number="9"><span class="co">#&gt; 3 (362900, 4640400)       544    NA     NA</span></div>
<div class="sourceLine" id="cb26-10" data-line-number="10"><span class="co">#&gt; 4 (360300, 4638600)       425    NA     NA</span></div></code></pre>
<p>In this case we only have elevation (in m), but slope and aspect should also be included if possible. Let us assume you want to interpolate on this points for the whole time series available in object <code>interpolator</code>. Since we are dealing with points, the function to interpolate is called <code>interpolationpoints</code>:</p>
<pre class="sourceCode r" id="cb27"><code class="sourceCode r"><div class="sourceLine" id="cb27-1" data-line-number="1">mp =<span class="st"> </span><span class="kw">interpolationpoints</span>(interpolator, spt)</div>
<div class="sourceLine" id="cb27-2" data-line-number="2"><span class="co">#&gt; Processing point '1' (1/4) - done.</span></div>
<div class="sourceLine" id="cb27-3" data-line-number="3"><span class="co">#&gt; Processing point '2' (2/4) - done.</span></div>
<div class="sourceLine" id="cb27-4" data-line-number="4"><span class="co">#&gt; Processing point '3' (3/4) - done.</span></div>
<div class="sourceLine" id="cb27-5" data-line-number="5"><span class="co">#&gt; Processing point '4' (4/4) - done.</span></div></code></pre>
<p>This function works processing one point at a time. The output of the function is an object of class <code>SpatialPointsMeteorology</code>:</p>
<pre class="sourceCode r" id="cb28"><code class="sourceCode r"><div class="sourceLine" id="cb28-1" data-line-number="1">mp</div>
<div class="sourceLine" id="cb28-2" data-line-number="2"><span class="co">#&gt; Object of class SpatialPointsMeteorology</span></div>
<div class="sourceLine" id="cb28-3" data-line-number="3"><span class="co">#&gt; Dates:  1461  (initial: 2000-01-01 final: 2003-12-31)</span></div>
<div class="sourceLine" id="cb28-4" data-line-number="4"><span class="co">#&gt; SpatialPoints:</span></div>
<div class="sourceLine" id="cb28-5" data-line-number="5"><span class="co">#&gt;    X_UTM   Y_UTM</span></div>
<div class="sourceLine" id="cb28-6" data-line-number="6"><span class="co">#&gt; 1 363500 4640900</span></div>
<div class="sourceLine" id="cb28-7" data-line-number="7"><span class="co">#&gt; 2 362700 4640700</span></div>
<div class="sourceLine" id="cb28-8" data-line-number="8"><span class="co">#&gt; 3 362900 4640400</span></div>
<div class="sourceLine" id="cb28-9" data-line-number="9"><span class="co">#&gt; 4 360300 4638600</span></div>
<div class="sourceLine" id="cb28-10" data-line-number="10"><span class="co">#&gt; Coordinate Reference System (CRS) arguments: +proj=utm +zone=31</span></div>
<div class="sourceLine" id="cb28-11" data-line-number="11"><span class="co">#&gt; +ellps=WGS84 +datum=WGS84 +units=m +towgs84=0,0,0</span></div></code></pre>
<p>And the time series for a given can be plotted using function <code>meteoplot</code>. For example, we show here the precipitation series of point #1:</p>
<pre class="sourceCode r" id="cb29"><code class="sourceCode r"><div class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">meteoplot</span>(mp, <span class="dv">1</span>, <span class="st">&quot;Precipitation&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Precipitation (mm)&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>)</div></code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Objects of class <code>SpatialPointsDataFrame</code> include a list of data frames, one per point. We can access one of them using:</p>
<pre class="sourceCode r" id="cb30"><code class="sourceCode r"><div class="sourceLine" id="cb30-1" data-line-number="1">df_<span class="dv">1</span> =<span class="st"> </span>mp<span class="op">@</span>data[[<span class="dv">1</span>]]</div>
<div class="sourceLine" id="cb30-2" data-line-number="2"><span class="kw">head</span>(df_<span class="dv">1</span>)</div>
<div class="sourceLine" id="cb30-3" data-line-number="3"><span class="co">#&gt;            DOY MeanTemperature MinTemperature MaxTemperature Precipitation</span></div>
<div class="sourceLine" id="cb30-4" data-line-number="4"><span class="co">#&gt; 2000-01-01   1        4.667837     -0.8252117       8.239225             0</span></div>
<div class="sourceLine" id="cb30-5" data-line-number="5"><span class="co">#&gt; 2000-01-02   2        5.334345     -0.8924180       9.382768             0</span></div>
<div class="sourceLine" id="cb30-6" data-line-number="6"><span class="co">#&gt; 2000-01-03   3        5.606611     -1.5197999      10.239954             0</span></div>
<div class="sourceLine" id="cb30-7" data-line-number="7"><span class="co">#&gt; 2000-01-04   4        2.763230     -1.3546669       5.440543             0</span></div>
<div class="sourceLine" id="cb30-8" data-line-number="8"><span class="co">#&gt; 2000-01-05   5        2.995939     -1.1467554       5.689375             0</span></div>
<div class="sourceLine" id="cb30-9" data-line-number="9"><span class="co">#&gt; 2000-01-06   6        1.688713     -1.9995148       4.086670             0</span></div>
<div class="sourceLine" id="cb30-10" data-line-number="10"><span class="co">#&gt;            MeanRelativeHumidity MinRelativeHumidity MaxRelativeHumidity</span></div>
<div class="sourceLine" id="cb30-11" data-line-number="11"><span class="co">#&gt; 2000-01-01             92.39055            72.21814                 100</span></div>
<div class="sourceLine" id="cb30-12" data-line-number="12"><span class="co">#&gt; 2000-01-02             93.37693            70.77216                 100</span></div>
<div class="sourceLine" id="cb30-13" data-line-number="13"><span class="co">#&gt; 2000-01-03             93.60100            68.25620                 100</span></div>
<div class="sourceLine" id="cb30-14" data-line-number="14"><span class="co">#&gt; 2000-01-04             93.54075            77.48781                 100</span></div>
<div class="sourceLine" id="cb30-15" data-line-number="15"><span class="co">#&gt; 2000-01-05             88.89305            73.58204                 100</span></div>
<div class="sourceLine" id="cb30-16" data-line-number="16"><span class="co">#&gt; 2000-01-06             81.61940            68.83603                 100</span></div>
<div class="sourceLine" id="cb30-17" data-line-number="17"><span class="co">#&gt;            Radiation WindSpeed WindDirection PET</span></div>
<div class="sourceLine" id="cb30-18" data-line-number="18"><span class="co">#&gt; 2000-01-01  1.711026        NA            NA   0</span></div>
<div class="sourceLine" id="cb30-19" data-line-number="19"><span class="co">#&gt; 2000-01-02  1.634646        NA            NA   0</span></div>
<div class="sourceLine" id="cb30-20" data-line-number="20"><span class="co">#&gt; 2000-01-03  1.571079        NA            NA   0</span></div>
<div class="sourceLine" id="cb30-21" data-line-number="21"><span class="co">#&gt; 2000-01-04  1.964851        NA            NA   0</span></div>
<div class="sourceLine" id="cb30-22" data-line-number="22"><span class="co">#&gt; 2000-01-05  1.964975        NA            NA   0</span></div>
<div class="sourceLine" id="cb30-23" data-line-number="23"><span class="co">#&gt; 2000-01-06  2.081055        NA            NA   0</span></div></code></pre>
<p>This data frame can now be written into a file for its analysis outside R. The package also provides its own functions to write/read point meteorology data in different formats. If we are interested in inspecting the interpolation result by date, instead of by point, we can use function <code>extractpointdates</code>, which returns objects of class <code>SpatialGridDataFrame</code>:</p>
<pre class="sourceCode r" id="cb31"><code class="sourceCode r"><div class="sourceLine" id="cb31-1" data-line-number="1">dt_<span class="dv">4</span> =<span class="st"> </span><span class="kw">extractpointdates</span>(mp, <span class="kw">as.Date</span>(<span class="st">&quot;2001-01-04&quot;</span>), <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</div>
<div class="sourceLine" id="cb31-2" data-line-number="2">dt_<span class="dv">4</span></div>
<div class="sourceLine" id="cb31-3" data-line-number="3"><span class="co">#&gt;         coordinates DOY MeanTemperature MinTemperature MaxTemperature</span></div>
<div class="sourceLine" id="cb31-4" data-line-number="4"><span class="co">#&gt; 1 (363500, 4640900)   4        8.831687       4.117643       11.89659</span></div>
<div class="sourceLine" id="cb31-5" data-line-number="5"><span class="co">#&gt; 2 (362700, 4640700)   4        8.888062       4.137959       11.97641</span></div>
<div class="sourceLine" id="cb31-6" data-line-number="6"><span class="co">#&gt; 3 (362900, 4640400)   4        8.783900       4.160745       11.78971</span></div>
<div class="sourceLine" id="cb31-7" data-line-number="7"><span class="co">#&gt; 4 (360300, 4638600)   4        9.160987       4.141817       12.42428</span></div>
<div class="sourceLine" id="cb31-8" data-line-number="8"><span class="co">#&gt;   Precipitation MeanRelativeHumidity MinRelativeHumidity</span></div>
<div class="sourceLine" id="cb31-9" data-line-number="9"><span class="co">#&gt; 1      2.115263             84.55443            68.89768</span></div>
<div class="sourceLine" id="cb31-10" data-line-number="10"><span class="co">#&gt; 2      2.121518             84.23693            68.53931</span></div>
<div class="sourceLine" id="cb31-11" data-line-number="11"><span class="co">#&gt; 3      2.094060             84.83321            69.38961</span></div>
<div class="sourceLine" id="cb31-12" data-line-number="12"><span class="co">#&gt; 4      2.193749             82.71191            66.55893</span></div>
<div class="sourceLine" id="cb31-13" data-line-number="13"><span class="co">#&gt;   MaxRelativeHumidity Radiation WindSpeed WindDirection PET</span></div>
<div class="sourceLine" id="cb31-14" data-line-number="14"><span class="co">#&gt; 1                 100  2.342170        NA            NA   0</span></div>
<div class="sourceLine" id="cb31-15" data-line-number="15"><span class="co">#&gt; 2                 100  2.342029        NA            NA   0</span></div>
<div class="sourceLine" id="cb31-16" data-line-number="16"><span class="co">#&gt; 3                 100  2.347890        NA            NA   0</span></div>
<div class="sourceLine" id="cb31-17" data-line-number="17"><span class="co">#&gt; 4                 100  2.330071        NA            NA   0</span></div></code></pre>
</div>
</div>
<div id="statistical-correction-of-daily-weather" class="section level1">
<h1>Statistical correction of daily weather</h1>
<p>Correcting the biases of a meteorological data series containing biases using a more accurate meteorological series is necessary when the more accurate series does not cover the period of interest and the less accurate series does. The less accurate series may be at coarser scale, as with climate model predictions or climate reanalysis data. In this case one can speak of statistical correction and downscaling. However, one may also correct the predictions of climate models using reanalysis data estimated at the same spatial resolution.</p>
<p>In the following example we will correct the predictions of Regional Climate Model (CCLM4-8-17; driving global model CNRM-CERFACS-CNRM-CM5) on the same area of the interpolation example. RCM data includes 3 model cells. Meteorological data covers an historical (reference) period (2000-2003) and a future (projection) period (year 2023), the latter simulated under rcp4.5 scenario.</p>
<div id="preparing-weather-data-to-be-downscaledcorrected" class="section level2">
<h2>Preparing weather data to be downscaled/corrected</h2>
<p>One needs several data items to perform downscaling and statistical correction. First, we need a matrix or data frame with the central coordinates of the RCM cells (here in longitude/latitude format):</p>
<pre class="sourceCode r" id="cb32"><code class="sourceCode r"><div class="sourceLine" id="cb32-1" data-line-number="1">pt_coords</div>
<div class="sourceLine" id="cb32-2" data-line-number="2"><span class="co">#&gt;       long      lat</span></div>
<div class="sourceLine" id="cb32-3" data-line-number="3"><span class="co">#&gt; 1 1.226384 41.79279</span></div>
<div class="sourceLine" id="cb32-4" data-line-number="4"><span class="co">#&gt; 2 1.368943 41.81727</span></div>
<div class="sourceLine" id="cb32-5" data-line-number="5"><span class="co">#&gt; 3 1.335890 41.92448</span></div></code></pre>
<p>Second, we need the uncorrected meteorological data (here RCM outputs) for both a reference period (that will be matched with our more accurate series) and a projection period (that our more accurate series does not cover). Both should be arranged in lists of data frames, one per RCM cell:</p>
<pre class="sourceCode r" id="cb33"><code class="sourceCode r"><div class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw">length</span>(ref_data)</div>
<div class="sourceLine" id="cb33-2" data-line-number="2"><span class="co">#&gt; [1] 3</span></div>
<div class="sourceLine" id="cb33-3" data-line-number="3"><span class="kw">length</span>(proj_data)</div>
<div class="sourceLine" id="cb33-4" data-line-number="4"><span class="co">#&gt; [1] 3</span></div>
<div class="sourceLine" id="cb33-5" data-line-number="5"><span class="kw">head</span>(ref_data[[<span class="dv">1</span>]])</div>
<div class="sourceLine" id="cb33-6" data-line-number="6"><span class="co">#&gt;            DOY MeanTemperature MinTemperature MaxTemperature Precipitation</span></div>
<div class="sourceLine" id="cb33-7" data-line-number="7"><span class="co">#&gt; 2000-01-01   1        7.008813       5.613855       9.692926  2.273821e-01</span></div>
<div class="sourceLine" id="cb33-8" data-line-number="8"><span class="co">#&gt; 2000-01-02   2        7.628625       6.728754       8.123132  1.979953e+01</span></div>
<div class="sourceLine" id="cb33-9" data-line-number="9"><span class="co">#&gt; 2000-01-03   3        7.204065       3.538507       9.701288  4.990360e+00</span></div>
<div class="sourceLine" id="cb33-10" data-line-number="10"><span class="co">#&gt; 2000-01-04   4        4.317285       1.941400       8.395471  0.000000e+00</span></div>
<div class="sourceLine" id="cb33-11" data-line-number="11"><span class="co">#&gt; 2000-01-05   5        4.235284       1.565973       8.663568  1.820105e-09</span></div>
<div class="sourceLine" id="cb33-12" data-line-number="12"><span class="co">#&gt; 2000-01-06   6        4.464075       2.094171       7.982202  2.747191e-03</span></div>
<div class="sourceLine" id="cb33-13" data-line-number="13"><span class="co">#&gt;            SpecificHumidity MeanRelativeHumidity Radiation WindSpeed</span></div>
<div class="sourceLine" id="cb33-14" data-line-number="14"><span class="co">#&gt; 2000-01-01      0.005365001             87.24593  6.479796  5.300286</span></div>
<div class="sourceLine" id="cb33-15" data-line-number="15"><span class="co">#&gt; 2000-01-02      0.006007533             93.63294  2.333908  4.713901</span></div>
<div class="sourceLine" id="cb33-16" data-line-number="16"><span class="co">#&gt; 2000-01-03      0.005704192             91.52707  4.233040  2.108916</span></div>
<div class="sourceLine" id="cb33-17" data-line-number="17"><span class="co">#&gt; 2000-01-04      0.004497202             88.16652  6.957025  1.168019</span></div>
<div class="sourceLine" id="cb33-18" data-line-number="18"><span class="co">#&gt; 2000-01-05      0.004520838             89.14193  6.588341  1.993287</span></div>
<div class="sourceLine" id="cb33-19" data-line-number="19"><span class="co">#&gt; 2000-01-06      0.004539691             88.08730  6.849565  1.955944</span></div>
<div class="sourceLine" id="cb33-20" data-line-number="20"><span class="kw">head</span>(proj_data[[<span class="dv">1</span>]])</div>
<div class="sourceLine" id="cb33-21" data-line-number="21"><span class="co">#&gt;            DOY MeanTemperature MinTemperature MaxTemperature Precipitation</span></div>
<div class="sourceLine" id="cb33-22" data-line-number="22"><span class="co">#&gt; 2023-01-01   1      0.52730713     -0.9837708       1.922754  5.914489e-10</span></div>
<div class="sourceLine" id="cb33-23" data-line-number="23"><span class="co">#&gt; 2023-01-02   2      2.08501587     -1.0495361       6.185968  2.419252e-01</span></div>
<div class="sourceLine" id="cb33-24" data-line-number="24"><span class="co">#&gt; 2023-01-03   3     -0.76285400     -3.2190002       2.428308  1.936977e-12</span></div>
<div class="sourceLine" id="cb33-25" data-line-number="25"><span class="co">#&gt; 2023-01-04   4      0.02242432     -1.7950195       1.537469  1.174330e-01</span></div>
<div class="sourceLine" id="cb33-26" data-line-number="26"><span class="co">#&gt; 2023-01-05   5      1.30117188     -1.0007385       3.657709  3.518532e+00</span></div>
<div class="sourceLine" id="cb33-27" data-line-number="27"><span class="co">#&gt; 2023-01-06   6     -1.27564087     -3.2251038       1.087396  1.464739e-09</span></div>
<div class="sourceLine" id="cb33-28" data-line-number="28"><span class="co">#&gt;            SpecificHumidity MeanRelativeHumidity Radiation WindSpeed</span></div>
<div class="sourceLine" id="cb33-29" data-line-number="29"><span class="co">#&gt; 2023-01-01      0.003752435             96.40739  6.263537  1.353957</span></div>
<div class="sourceLine" id="cb33-30" data-line-number="30"><span class="co">#&gt; 2023-01-02      0.003748596             86.08917  5.417012  2.057226</span></div>
<div class="sourceLine" id="cb33-31" data-line-number="31"><span class="co">#&gt; 2023-01-03      0.003032080             85.58024  7.274775  1.688474</span></div>
<div class="sourceLine" id="cb33-32" data-line-number="32"><span class="co">#&gt; 2023-01-04      0.003270915             87.17539  3.522371  1.115798</span></div>
<div class="sourceLine" id="cb33-33" data-line-number="33"><span class="co">#&gt; 2023-01-05      0.003813237             92.64220  5.621084  1.008287</span></div>
<div class="sourceLine" id="cb33-34" data-line-number="34"><span class="co">#&gt; 2023-01-06      0.003074167             90.09795  7.251414  1.606562</span></div></code></pre>
<p>Note that these data frames should follow the conventions of <code>meteoland</code> for variable names and units. Finally, we need to specify the projection period, in this case one year:</p>
<pre class="sourceCode r" id="cb34"><code class="sourceCode r"><div class="sourceLine" id="cb34-1" data-line-number="1">proj_dates =<span class="st"> </span><span class="kw">seq</span>(<span class="kw">as.Date</span>(<span class="st">&quot;2023-01-01&quot;</span>), <span class="kw">as.Date</span>(<span class="st">&quot;2023-12-31&quot;</span>), <span class="dt">by=</span><span class="st">&quot;day&quot;</span>)</div></code></pre>
</div>
<div id="building-the-uncorrected-data-object" class="section level2">
<h2>Building the uncorrected data object</h2>
<p>Statistical correction needs an object of class <code>MeteorologyUncorrectedData</code>, analogous to the <code>MeteorologyInterpolationData</code> of the previous section. To build this object we need first to express coordinates in an object <code>SpatialPoints</code>:</p>
<pre class="sourceCode r" id="cb35"><code class="sourceCode r"><div class="sourceLine" id="cb35-1" data-line-number="1">sp =<span class="st"> </span><span class="kw">SpatialPoints</span>(pt_coords, <span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0&quot;</span>))</div>
<div class="sourceLine" id="cb35-2" data-line-number="2">sp</div>
<div class="sourceLine" id="cb35-3" data-line-number="3"><span class="co">#&gt; SpatialPoints:</span></div>
<div class="sourceLine" id="cb35-4" data-line-number="4"><span class="co">#&gt;          long      lat</span></div>
<div class="sourceLine" id="cb35-5" data-line-number="5"><span class="co">#&gt; [1,] 1.226384 41.79279</span></div>
<div class="sourceLine" id="cb35-6" data-line-number="6"><span class="co">#&gt; [2,] 1.368943 41.81727</span></div>
<div class="sourceLine" id="cb35-7" data-line-number="7"><span class="co">#&gt; [3,] 1.335890 41.92448</span></div>
<div class="sourceLine" id="cb35-8" data-line-number="8"><span class="co">#&gt; Coordinate Reference System (CRS) arguments: +proj=longlat</span></div>
<div class="sourceLine" id="cb35-9" data-line-number="9"><span class="co">#&gt; +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0</span></div></code></pre>
<p>Assuming the weather data to be corrected is in the proper format, the object is constructed using:</p>
<pre class="sourceCode r" id="cb36"><code class="sourceCode r"><div class="sourceLine" id="cb36-1" data-line-number="1">uncorrected =<span class="st"> </span><span class="kw">MeteorologyUncorrectedData</span>(sp, ref_data, proj_data, proj_dates)</div></code></pre>
</div>
<div id="target-point-weather-meteorology-taken-as-reference" class="section level2">
<h2>Target point weather meteorology taken as reference</h2>
<p>Downscaling/statistical correction is done on a set of target spatial points. meteoland will first find the RCM cell to which each point is nearest (using the central coordinates of RCM cells). Once this matching is done, statistical relations are build between the meteorology of RCM cells and that of target points for the reference period (here 2000-2003) which are used to correct RCM data for the projection period (year 2023). For this process to be done, we need the coordinates and weather series for the reference period. In our case, we will employ a copy the object of class <code>SpatialPointsMeteorology</code> that resulted from interpolation in the previous section:</p>
<pre class="sourceCode r" id="cb37"><code class="sourceCode r"><div class="sourceLine" id="cb37-1" data-line-number="1">historical  =<span class="st"> </span>mp</div>
<div class="sourceLine" id="cb37-2" data-line-number="2">historical</div>
<div class="sourceLine" id="cb37-3" data-line-number="3"><span class="co">#&gt; Object of class SpatialPointsMeteorology</span></div>
<div class="sourceLine" id="cb37-4" data-line-number="4"><span class="co">#&gt; Dates:  1461  (initial: 2000-01-01 final: 2003-12-31)</span></div>
<div class="sourceLine" id="cb37-5" data-line-number="5"><span class="co">#&gt; SpatialPoints:</span></div>
<div class="sourceLine" id="cb37-6" data-line-number="6"><span class="co">#&gt;    X_UTM   Y_UTM</span></div>
<div class="sourceLine" id="cb37-7" data-line-number="7"><span class="co">#&gt; 1 363500 4640900</span></div>
<div class="sourceLine" id="cb37-8" data-line-number="8"><span class="co">#&gt; 2 362700 4640700</span></div>
<div class="sourceLine" id="cb37-9" data-line-number="9"><span class="co">#&gt; 3 362900 4640400</span></div>
<div class="sourceLine" id="cb37-10" data-line-number="10"><span class="co">#&gt; 4 360300 4638600</span></div>
<div class="sourceLine" id="cb37-11" data-line-number="11"><span class="co">#&gt; Coordinate Reference System (CRS) arguments: +proj=utm +zone=31</span></div>
<div class="sourceLine" id="cb37-12" data-line-number="12"><span class="co">#&gt; +ellps=WGS84 +datum=WGS84 +units=m +towgs84=0,0,0</span></div></code></pre>
<p>We named it <code>historical</code> to remind that we are using the historical period as reference and want to correct the RCM series for the projection period There are several ways to shape data into objects of class <code>SpatialPointsMeteorology</code>. For example, one can use function <code>readmeteorologypoints</code>.</p>
</div>
<div id="tuning-correction-parameters" class="section level2">
<h2>Tuning correction parameters</h2>
<p>Objects of class <code>MeteorologyUncorrectedData</code> have a slot with parameters:</p>
<pre class="sourceCode r" id="cb38"><code class="sourceCode r"><div class="sourceLine" id="cb38-1" data-line-number="1">uncorrected<span class="op">@</span>params</div>
<div class="sourceLine" id="cb38-2" data-line-number="2"><span class="co">#&gt; $varmethods</span></div>
<div class="sourceLine" id="cb38-3" data-line-number="3"><span class="co">#&gt; $varmethods$MeanTemperature</span></div>
<div class="sourceLine" id="cb38-4" data-line-number="4"><span class="co">#&gt; [1] &quot;unbias&quot;</span></div>
<div class="sourceLine" id="cb38-5" data-line-number="5"><span class="co">#&gt; </span></div>
<div class="sourceLine" id="cb38-6" data-line-number="6"><span class="co">#&gt; $varmethods$MinTemperature</span></div>
<div class="sourceLine" id="cb38-7" data-line-number="7"><span class="co">#&gt; [1] &quot;quantmap&quot;</span></div>
<div class="sourceLine" id="cb38-8" data-line-number="8"><span class="co">#&gt; </span></div>
<div class="sourceLine" id="cb38-9" data-line-number="9"><span class="co">#&gt; $varmethods$MaxTemperature</span></div>
<div class="sourceLine" id="cb38-10" data-line-number="10"><span class="co">#&gt; [1] &quot;quantmap&quot;</span></div>
<div class="sourceLine" id="cb38-11" data-line-number="11"><span class="co">#&gt; </span></div>
<div class="sourceLine" id="cb38-12" data-line-number="12"><span class="co">#&gt; $varmethods$Precipitation</span></div>
<div class="sourceLine" id="cb38-13" data-line-number="13"><span class="co">#&gt; [1] &quot;quantmap&quot;</span></div>
<div class="sourceLine" id="cb38-14" data-line-number="14"><span class="co">#&gt; </span></div>
<div class="sourceLine" id="cb38-15" data-line-number="15"><span class="co">#&gt; $varmethods$MeanRelativeHumidity</span></div>
<div class="sourceLine" id="cb38-16" data-line-number="16"><span class="co">#&gt; [1] &quot;unbias&quot;</span></div>
<div class="sourceLine" id="cb38-17" data-line-number="17"><span class="co">#&gt; </span></div>
<div class="sourceLine" id="cb38-18" data-line-number="18"><span class="co">#&gt; $varmethods$Radiation</span></div>
<div class="sourceLine" id="cb38-19" data-line-number="19"><span class="co">#&gt; [1] &quot;unbias&quot;</span></div>
<div class="sourceLine" id="cb38-20" data-line-number="20"><span class="co">#&gt; </span></div>
<div class="sourceLine" id="cb38-21" data-line-number="21"><span class="co">#&gt; $varmethods$WindSpeed</span></div>
<div class="sourceLine" id="cb38-22" data-line-number="22"><span class="co">#&gt; [1] &quot;quantmap&quot;</span></div>
<div class="sourceLine" id="cb38-23" data-line-number="23"><span class="co">#&gt; </span></div>
<div class="sourceLine" id="cb38-24" data-line-number="24"><span class="co">#&gt; </span></div>
<div class="sourceLine" id="cb38-25" data-line-number="25"><span class="co">#&gt; $qstep</span></div>
<div class="sourceLine" id="cb38-26" data-line-number="26"><span class="co">#&gt; [1] 0.01</span></div>
<div class="sourceLine" id="cb38-27" data-line-number="27"><span class="co">#&gt; </span></div>
<div class="sourceLine" id="cb38-28" data-line-number="28"><span class="co">#&gt; $fill_wind</span></div>
<div class="sourceLine" id="cb38-29" data-line-number="29"><span class="co">#&gt; [1] TRUE</span></div>
<div class="sourceLine" id="cb38-30" data-line-number="30"><span class="co">#&gt; </span></div>
<div class="sourceLine" id="cb38-31" data-line-number="31"><span class="co">#&gt; $allow_saturated</span></div>
<div class="sourceLine" id="cb38-32" data-line-number="32"><span class="co">#&gt; [1] FALSE</span></div>
<div class="sourceLine" id="cb38-33" data-line-number="33"><span class="co">#&gt; </span></div>
<div class="sourceLine" id="cb38-34" data-line-number="34"><span class="co">#&gt; $wind_height</span></div>
<div class="sourceLine" id="cb38-35" data-line-number="35"><span class="co">#&gt; [1] 10</span></div></code></pre>
<p>Importantly, <code>varmethods</code> is a named list that specifies which correction method has to be used for each variable. Since we do not have reference data for wind speed, we must turn the method for wind speed to <code>&quot;none&quot;</code>:</p>
<pre class="sourceCode r" id="cb39"><code class="sourceCode r"><div class="sourceLine" id="cb39-1" data-line-number="1">uncorrected<span class="op">@</span>params<span class="op">$</span>varmethods<span class="op">$</span>WindSpeed=<span class="st">&quot;none&quot;</span></div></code></pre>
</div>
<div id="conducting-statistical-correction" class="section level2">
<h2>Conducting statistical correction</h2>
<p>Once we have all the data objects that we need (the hard part), conducting statistical correction is straightforward:</p>
<pre class="sourceCode r" id="cb40"><code class="sourceCode r"><div class="sourceLine" id="cb40-1" data-line-number="1">projected =<span class="st"> </span><span class="kw">correctionpoints</span>(uncorrected, historical)</div>
<div class="sourceLine" id="cb40-2" data-line-number="2"><span class="co">#&gt; Points to correct: 4</span></div>
<div class="sourceLine" id="cb40-3" data-line-number="3"><span class="co">#&gt; All points inside boundary box.</span></div>
<div class="sourceLine" id="cb40-4" data-line-number="4"><span class="co">#&gt; Correcting point '1' (1/4) - ipred = 3 done.</span></div>
<div class="sourceLine" id="cb40-5" data-line-number="5"><span class="co">#&gt; Correcting point '2' (2/4) - ipred = 3 done.</span></div>
<div class="sourceLine" id="cb40-6" data-line-number="6"><span class="co">#&gt; Correcting point '3' (3/4) - ipred = 3 done.</span></div>
<div class="sourceLine" id="cb40-7" data-line-number="7"><span class="co">#&gt; Correcting point '4' (4/4) - ipred = 3 done.</span></div></code></pre>
<p>As mentioned above, correction proceeds point by point. The result is again an object of class <code>SpatialPointsMeteorology</code>:</p>
<pre class="sourceCode r" id="cb41"><code class="sourceCode r"><div class="sourceLine" id="cb41-1" data-line-number="1">projected</div>
<div class="sourceLine" id="cb41-2" data-line-number="2"><span class="co">#&gt; Object of class SpatialPointsMeteorology</span></div>
<div class="sourceLine" id="cb41-3" data-line-number="3"><span class="co">#&gt; Dates:  365  (initial: 2023-01-01 final: 2023-12-31)</span></div>
<div class="sourceLine" id="cb41-4" data-line-number="4"><span class="co">#&gt; SpatialPoints:</span></div>
<div class="sourceLine" id="cb41-5" data-line-number="5"><span class="co">#&gt;    X_UTM   Y_UTM</span></div>
<div class="sourceLine" id="cb41-6" data-line-number="6"><span class="co">#&gt; 1 363500 4640900</span></div>
<div class="sourceLine" id="cb41-7" data-line-number="7"><span class="co">#&gt; 2 362700 4640700</span></div>
<div class="sourceLine" id="cb41-8" data-line-number="8"><span class="co">#&gt; 3 362900 4640400</span></div>
<div class="sourceLine" id="cb41-9" data-line-number="9"><span class="co">#&gt; 4 360300 4638600</span></div>
<div class="sourceLine" id="cb41-10" data-line-number="10"><span class="co">#&gt; Coordinate Reference System (CRS) arguments: +proj=utm +zone=31</span></div>
<div class="sourceLine" id="cb41-11" data-line-number="11"><span class="co">#&gt; +ellps=WGS84 +datum=WGS84 +units=m +towgs84=0,0,0</span></div></code></pre>
<p>The following code displays the minimum/maximum temperatures before and after correction:</p>
<pre class="sourceCode r" id="cb42"><code class="sourceCode r"><div class="sourceLine" id="cb42-1" data-line-number="1"><span class="co">#Plot predicted mean temperature for point 1</span></div>
<div class="sourceLine" id="cb42-2" data-line-number="2"><span class="kw">meteoplot</span>(projected, <span class="dv">1</span>, <span class="st">&quot;MinTemperature&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Temperature (Celsius)&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">40</span>), <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</div>
<div class="sourceLine" id="cb42-3" data-line-number="3"><span class="kw">meteoplot</span>(projected, <span class="dv">1</span>, <span class="st">&quot;MaxTemperature&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</div>
<div class="sourceLine" id="cb42-4" data-line-number="4"><span class="co">#Add uncorrected mean temperature data (cell #3)</span></div>
<div class="sourceLine" id="cb42-5" data-line-number="5"><span class="kw">lines</span>(uncorrected<span class="op">@</span>dates,</div>
<div class="sourceLine" id="cb42-6" data-line-number="6">      uncorrected<span class="op">@</span>projection_data[[<span class="dv">3</span>]]<span class="op">$</span>MinTemperature,</div>
<div class="sourceLine" id="cb42-7" data-line-number="7">      <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">lty=</span><span class="dv">3</span>)</div>
<div class="sourceLine" id="cb42-8" data-line-number="8"><span class="kw">lines</span>(uncorrected<span class="op">@</span>dates,</div>
<div class="sourceLine" id="cb42-9" data-line-number="9">      uncorrected<span class="op">@</span>projection_data[[<span class="dv">3</span>]]<span class="op">$</span>MaxTemperature,</div>
<div class="sourceLine" id="cb42-10" data-line-number="10">      <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lty=</span><span class="dv">3</span>)</div>
<div class="sourceLine" id="cb42-11" data-line-number="11"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;corrected&quot;</span>,<span class="st">&quot;uncorrected&quot;</span>, <span class="st">&quot;Maximum&quot;</span>, <span class="st">&quot;Minimum&quot;</span>), </div>
<div class="sourceLine" id="cb42-12" data-line-number="12">       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</div></code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAAAhFBMVEUAAAAAADoAAGYAAP8AOjoAOpAAZmYAZrY6AAA6ADo6AGY6Ojo6OpA6kNtmAABmADpmAGZmZgBmZmZmkJBmtrZmtv+QOgCQOjqQZgCQkGaQtpCQ27aQ2/+2ZgC225C2/7a2/9u2///bkDrb2//b/9vb////AAD/tmb/25D//7b//9v////rpvmEAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2diYLcOJKeSw3L0oxX6vHuqOyxVTuesoVSFd7//Zw8AMSFg1dmMDP+blXyAEES/BgRAAHyKZhMivV06wMwmWoyQE2qZYCaVMsANamWAWpSLQPUpFoGqEm1DFCTahmgJtUyQE2qZYCaVMsANamWAWpSLQPUpFoGqEm1DFCTahmgJtUyQE2qZYCaVMsANamWAWpSLQPUpFoGqEm1DFCTahmgJtUyQE2qZYCaVMsANamWAWpSLQPUpFoGqEm1DFCTahmgJtUyQE2qZYCaVMsANamWAWpSLQPUpFoGqEm1DFCTahmgJtUyQE2qZYCaVMsANamWAWpSLQPUpFoGqEm1DFCTahmgJtUyQE2qZYCaVMsANamWAWpSLQPUpFoGqEm1DFCTahmgJtUyQE2qZYCaVMsANamWAWpSLQPUpFoGqEm1DFCTahmgJtUyQE2qZYCaVMsANamWAWpSLQPUpFoGqEm1DFCTahmgJtUyQE2qZYCaVMsANamWAWpSrZ0BfTKZunQrQPfNznSvMkBNqnUQoB/Pk33+41+7ZGd6WB0D6OvTt2niLU5sys70uDoE0I/nhOXr51+bszM9sA4B9P37jzj5VnDyBqipS2ZBTap1VAw6m1CLQU3bdFAt/v37VIsv2E8D1NQpawc1qdaVAV3+BMv02DoU0N9ff5RWGaCmLh3UzJQtpTUzmbboGAs6V97Ngpq26rBa/FB/N0BNkt4YFm+ffhbSHhaDvlx2aYCaBIEHjVE3AHToMGKAmgQpAfRiP/+LAfo4er3UiL+Eof7xNNRA3v/8x9Mf/xz+/Gtc9S2l+f11fIADF376xy0AHTqFGqBn1pKxGK8XxN6/f7vw+ePy+2WqhUxVkdcx2vuW0owWNC18uRD89nQTQK+YnenGGtgcNPUTunjscUH+M3Rri2kGQNPCKQx8MUBNhypWN6bfy9/RTI5/pvjysiimGZamhVN/zJvEoNfMznRj/f7LRNgE4QVBAOgcEvyIaUZA48JXA9R0BTUtKEiTLWiIPdoNUNOxEmLQCGhqVcIx6LxwovbVADUdqwGxj+cvoBaf2BzpG6pBc5oRVLTQavGmw0XbQYHxfI2dhuY0L7EdNC68UTvoFbMz3asMUJNqGaAm1TJATaplgJpUywA1qZYBegL5Wx/ADWWAnkD3DmhtCIgBql/+zgGt9rA3QK+sFbAZoD0yQPfRGkBP4OPjk83373///jQOpNhpCIgBemXdPaBz/4+9hoAYoFfWctb8zWpJw7ij2j+gDOi3uTvoTkNADNAry1dnC1ucyYJOv7sNATFAryxS47lbQPcaAmKAXlmPAuheQ0AM0CtrGaA+nAbQb4jD3YaAGKDXFamRt5o4TwPox/PnX8OLOhKCew0BMUCvKwpogz2fGNWu4Z2wf4eh5k5DQAzQ62opoP4sgB4lA/S6MkAXygC9rmRAiwAaoAbodbUMUD9XowzQHRPeJLvTaDGgobb+AWSAXlfrAN1I6Jn5NkCvKwxobEUyQIsyQK8rXOm5H0A/nufPBr8J32cVeiR3ywC9rmRASwj1AurrVanrADqB+VL+gPAqGaDXlUePLjsBbfZYbjRGXQXQ//rn8PDn/W//3QA9s9YA6k8B6JeXsVvI5/85APryNI77GPrOzV3mf38dxoJ8G8Z3/Ai5zxNYKMsAva4YoNPsHVjQL28jmd9eLj8vX+ILQ7+F18+/JkCHjiDjiKShL30EFCyUMzZAr6tVgHb0yqsBunpUqK8KJb0A+vuvF3P5588LoO+Dtx/7zb398c8/f4YJ0LE/Hu6UhxbKx2CAXlcIUJ+W1F18T7dRX2kLuI4F/Xj+cfHwv16mGPRt8tovQ2+lCdAfIf1B3ZrzH0kG6FWF+3fOgJYBTASfAdDw+uXi4cPL1HXuj/8ckRu6gxqg59EyQLOH3wboFYLQAdDff/0//+PnAGhG7uP538d6kgF6Es119qWANgjDufLVVzChA6Afz/9xCUMvgI7jikbb+fr5/13qSQKg3/K4TgNUkdYAWq2gg3xuDugUcM4W9P3700Tm21RpRyzGASIGqDYhQOPfNqC+7qY9+hFWXwnQ0WjOMeinny+fhhr9NOiIABoHiBig2rQUUNAQugHQM7997CBAL/Z7VKn59ZEBTU+G+gGthpgCoDgqqAGqHt1jAH2du7ZcjP63HbK7H60ANKUyQPdJGOJo/VGvha4DBmhvDJqjgvKjTEoobjqthAf6nf8hgIL+f28FJ2+A9gEKnyWVMQP1/RD30BUd6H+zo1nQqwow2QMoCkJr1XT8G9CzcgOU6zX2nrIYFAsCCmroZUBRgFmupsPcA8Q/YMz58TwmoGM716Bi59WHBhThVukM72nSUq5k7B0BtGp6HxTQa2d3FgmAlm2jp5MFmGIGvgRobczTToCiMUlwDNKW8UiDVgCa3jW6ZndJKzY+rTyb6gTU0wXiXMposYuvxQ3LpGZM0sV3f0mHVGyGn/T2lN+it3q/96CDAPUkXQ3QcgyxF6A6xiS9/w0yieegXoaRJv/2q2zgDdDNLh4DSnMkMWh5B3sBCsYkTW+knb5Hs2U80qBjYtBxXMpoPa2ZKRwGKKo7+UoMuhZQVxVKisYkTYBOL6PdMh5p0HEN9dMr8q2hPuCHOvl3nYv3bHUOQT1cDu3rVSwoGJMUvysz901eOx5p0ApAh12/VlqQ4svHP/5vMAs6iDS3x9/9ACW/hFtkXFl++wGaxySll87PX1VY25t+0ApAxx6pX8ahpSUlox3fk79+v3cgj1hME+tcPAM0xp+pyYgBGq4DaB6TdFtAp6/a/Cg671HzVxreto/HvwPJgHqcRNyOTnohC0BsEdBCfyYpsl0pNCbp9oC+tELb/uzuXeNT8ZWAsqUCoJ6lJ29lHiNQOQjdGdA0JqkBaPd4pEFrXPyX4Zugw6dFNuhxAE1/wh6AItgjhzh7AVC5luTRzzahMUlVQBeMRxq0qpL09OnneEAbZICuc/EZ0TKgeGsfNxTzpweyVmhMUhXQBeORBtmz+IPVDSjnpAgoqhyBRJBcPHL0cEAPkwF6sLYAWnDxJUDBCg9w9TVAw/0BGnvStZ7E77Tfs6sPUOi487JeQGG2NKsYkJYA1d4jdLUFrbYy7bjfs4sC6vFETsYA9Xz91CIAAUXZA1pTF1F2b6AdNMYzK9B6F19rqN9xv2cXrbisBzSazFxJZ4ECqjEBduVIUwgS9Gk9oNtM6IMDygwXNXgsSbaS0XTysSIeUkvs7OPEoFHWUN8lCmhavBDQQCgHgHqUAlpp6POlI/Nklwq1GlBrqO+Spz9LLCjNCPprEEAyQIWZBwK0OR5u3/2eXEVAqXX0HYCCTCKrjRg03w4ioMJ+tMnaQY/VJkBldCKgnuUSH7rnrHxOzzIzQK+YnVoxQOPyNYB6tCq+PgRVpUDHEBSQChwKUUXrNG4gA/RYcUBnegiy8VtxRRePliS2GKCgZx2quosW9A4BHb/KZE+S+kUBpSMwi4BWX+rJxnGC7FPOEFDpWadnE+X9nQbQ6+/35EIcQofbBLQKTq6BE/uJ4U0G1gA9bL8atOHyUEDTcjEGbQBKavLBS9zRGhmMQTHNshkWz+JUgLYHze25Xw3aFVBCRXLIrTpNIICmjVgqDCicJq1Ydwpox6C5HferQTsCSp65p4FvXYCinIREeB0G1AuANnYF0p4J0K5Bc/vtV4N2AdRL/GVOBUDF3aLIkSRCG+AY9MEAfbBBczsCWkrVBSgKI71c9UGZBgq0p6tDF32nAvQBB82tvzzQx6IYlKZIj4D6YtC0USUV7O0U834IQB9v0NwegHqBEWDlugBlyxmxaJdzvvM0B7SUi7DTUwF63f1q0K6ACuvjA0rIVzEGxQTjNCQI9SCZAXrQfhVow+VhgFZ2gQBFthBmB/msZkmPe5OL3xKGb5MB2tY+gMJX0nBDJgFays7j2dIuucUsA9o4w/MAmh7EP9Kz+D0BFf247wU0hDosvNqeV5EQg6LbOI2zAHr9/SrQekARH6zrEaAxuXj4jF7arScE12JQtqEBesB+j9KCEt8FUJQNy7AT0PTgKf7yjGoHgwH1YKpxiicD9OLnP/96Kbz4c+/9HqXbAeqp+UoLQcf3agzqQzERa8YC0yQAAIA2AGyb2OO05jM0n36+Dg31mwi9PaD9Rb4noDgSREsOiEExnyxCzavuCdDhQ5zDi71P/qjzyoCKS5ANYy5e3CvrbFI+VE9X1QAtBr21g7mG1j2LHwA9eWeRGwFaWO7n3fg6oHQ0JzuyGkolF5+C0+J5ngvQaEFfNnUIvTWgS8L+1YAWA0kvJUJWtBKDkhChtlNsr6uA1vz8uQCdY9DXVZ9CXL7fg7SkzNcBKu7BoxUzb3Eu4Vc/uNrREDo7Y9BWzicDdGqtL37kcOf9HqQ9AZUvehFQNhcjwAmgbEgruyuZ0KL5JBHENkCvSeujtoMuA7SedAGgQrq0ZAZzAqkRgyCj2ykCqIcrSseVtxT2fhU9JqCNrhs0dT0pu+g+TpcCScQVxCPXlWqVHXGylZTt7V4BnTqCjp+wu8p+D5FPf7oS1w3VEkA9+Edq5Mgq9saZ1eOSqGq5eDHzMwE6dKaHv4fv9xAdAKjPU5MvrY0IxjMecYNrTq1D61/p8ZlsAPSqvUOXApoal878JIkYk2bqbkCzj64yVvS8zWedzYwayesxaOmYTwTo0Ag6q/SZ2J33e4SWAtrwuBTQ4OuAYuNK49GF9Z6FqxuAFkc5nQXQ8fNMk078JGmJkWpa0BKg4lYxqRSD7q+lMWgvoNcMQpe/PCwuOPGz+AMAzb2RfWgBSmfQ9fdSyvK+++VRBHGvgIL3iZz4UecRgCYwPawsVfcvHtFhgAYS4m5w8ZoBTd9VrH5g8RKrNoaFnArQjhhUArSxCT6YJUe0RfHc8RHwShrexp8G0PD2NDr516daJT6tfSsl0wBoZzk3eksuAhTuedlRbBcKQr20Lh87WevDeQCdjWP1tQ0ddf1TAdrp4n0yRk1A6VEwf4s2dl3H2ZKHgbF8Rl728vgItQPaoY66/pkArV9VqW2JANreT7ZuxwEaEKDkVkmzMqDygOVr6BBA78yC1oPWIqB8f/KSNsg7AQr3gQFFnUP5YXjacqsX0Pe/QYOI54BSZ1GVMahnE/Xk1ac7yamX25aEHS6KQd1OLn76i0JRfggyoOdx8e/fY/h5iUXLLaHNr32dCtCai+8BlO7Z5RnXEYO6fUzoHINKgOJD5ICG8wAaBqs46bQ96pcCWo1BQc2oBKinTtqFtMTBnIUYdEq6nwmVRzMBKgVAPWZSQvg4Xbk/aH5xzi7ZrdNiQAE1LLpsADoPdqeA+gSoq8egSwDtS1UAVDzHeN/4uwP0NVrY0gPRMwEKx1ISADsAHf9HhnKE0oHpinYEFNnm2k4FQMOdAfr66ef8OeTzA+pB3BZ7u+eV+Rl8tacxBTQAQPGRUBfvxv/bh+madSkf0qGKxykUC0iLe5Jej9ADm5k+niuvdzgToAEBGjYAOk06GINCdKUYdKSzB1DXVdlPjWL8QGuA5rv0LgCNDfUvn3/dBaDQ1QGWArjeQQY0JqOAegooPByYRz+gva1R06HWWhty+aDQ5o4ATQ31L19uB2i5DBe7eAlQ6ClRl1BpVzAGdTQGZQezEtAFlaT6ieebD8egwLjrBrT9druI5SXlXQGaf9Ajo3bDIAWUxqA5C48BmDx3H6A9yXyFL2LBfSBtpmcBtOftdvFR0sfzrQCt+DCxElBNzQD1JGDsBHScdLgdNNWSsE1Oq10Xei70pAKAVmpJEqAkPNYM6DneblcLsmgkeSCgUgzqUDtokHx8NqC96PUCSg+9nMRnQOnZ6gb0FG+3k01EXokBrRZ3fhBdBrTBJ45BZ0BnF5+oEgOPOqCOTC4BtJkEAwoOTDugp3i7XRtQaBn7AIUEdQIa5VAMOnGHAS0MFnLkl2RLJrtcfNvez3Sy5/YnAfQUb7erAcrKudVjfj9Ax+kAq9wgBsWHlxPDX5ItmextCC0hRgElt/JZAD3D2+3agKIYtAUoviieXbKWSXIgwQSoJ4AWtD+goQIoTAFMbSsGPZTWO315WBNQ6LwagBIaNwA6/p0BnVclQOUsOgGdLbTja8SDasag0UfgLoQnARR0l7/GftdpiYtv1BrS8/cVgEaBJ+7R1GFAXSGL1YAWHysVXhoVj89NaTCgeXX8wYAeSei6WvwV97tOHYCmNFJajydxl/Jcd1gRg0ZAsYt3hRyqgKZcnaOpypFDBFSOQV0CdF4A3Ts4bY+20gXoxvalpftdpyUuvgPQsA7QtBjwNwNKYtASTgsBzSa14uQrnVpcEAH1sNA8OvOgD9D0uc6ztoNiQH0ZUJ97eGJA6T5aISiMQSOgE6EuAdp28Qw5x/AFxBYtaM3eR0BzatTBkN7aybAeSOh9VpLKNoLFnjVAs3v3wnVIC/AFDMIMj0GdT5ZzejJfB3REhz6VrwBKcc5zpCMTSuYLgKJTAkVRe266lx4BUMYVKmmxl1wufx/ndwB0nJz+ODxRiEGRz2bdRqqAYvQYoJ6tCBlQsMSnssh/vG5Az+DiW4CC6S5AxTir6OJpiCrGoPME7jpChWs9jnjufkBRnR44arrfAqD5PvWwZu91AjprY1XpeECJZwrSXHTxVUB9kFN5uh/GqxiDxnbQGIOO/rgQg9JqOW49SjitAJTtAOeY0uKuyuTpkve8DPbWehf/Un090277XSUCKHW90MTl8oZpcgwQKeW2Avr/ZFLwIUQ5l5JHQHPtfQRUjkEFQNHTI5dyx+kJoGgrsieEbtnFpzl0vyZgNQKquTfTroDm1TKgMInPszQGhU6VxqCuFIOCqchyYMscS18FFPx1DFAereAY1IeMpXJANfcHbQAKp8uAZlNR3IloMdM1A4FnTjs59dS8NA/p6IpB8UQFUNq0KjQ6+TkJreyLgHoKaL679QI6jSo+fr+rRGPQku/NgNLw0mdAJaOZEomQsjWzhZxcvEOARhcvngdALxtHCihtImCA1sYtc0DZ3Yx6AoIYFAJ6HKHra/Gav5NEAZUh82gab58BTV47gAaWlIhcMnApoSYXP1utiSoag4rnIQDKHheRsDRtVQKUBMeoLuWpDfV0A2RKAzr7Y3S/7aAIFo9WRSghb9ywAusBrQZIBuD24MrxHF1uiU/1msjSZFDFC+wkQHOg2QtoEACNNwsBlLyjB5QWtaJ6AX3/c+oJeppKEgc0TfcCyjOPm/NshbDBgRkag4IZJoYeXBqb7ZcCmo+XjWh2pFcMLAMEaDgDoForSak024CWDB4ClF4vCqgUg9IQFBwEA1Soq4DthGkKaGgB6kovdWDNpZdjdDToJjdpLlUE6GGELv4MTX4/ndJPIbYBlWcooB4AmmJQvKdiDEpDUGBEcWWctWDS7aTpVP+XAZV6LwNAvZh6mveBPHQt+A+fXIL8mHdHrbegV9pvUbU+bp2Aor67BFBU/rIb645BHVjBAGUOOcDtpGkKKEnl0AaOWuh8Lo4D6smB8OJJMahaQK+836KKgNKwqBqDFgEVktNFxRiUhALRxY+TM5cwBp2TcJUATYazG1CWv4/LSC0eexhwIqygiLNQBGhsZ7pxDLoDoCgTAbHA3XoxYWUn0IK6RAXqnFSOEQvLnYyeAKj0ahJgzOlNUAKUKQMq+5edtALQ4Z11XxpfmttvvyUVn/FEQH0RUI8SgxVsKu6mcJ18QBfIw6sG5bIRdWzxNLkaUMe2oBaUAoqjDRqDNkJQkgfw9iwAKm27TGsa6r+Ft+HVN7d9cUM3oNxBgSixA1AhD5IQxaDSUUES2WKGCVwvC0auRUBjEtafz8PEvJIE09VjmFC9f7sBrSdcN2ju91//Nf5brx0Alc+MPX0jDoiYxz5A2a7ZpJh/FDOVEK9yDLoToMW3j7E9YxePnbcvnGHxxG8G6DDseKjJKwdUsqNoIsDVoQxo0XBO24tGBosHmwyvwyyo/Ho84OLLgOLUcnkDa6oG0LGF/uXb7V18A1BfBLQRg5JsK5eHBJ6FRKgugl185nM/QB0FlLt4D/PHd0zRxQfRc8AonN7XnYQ2xmyvaWZ6+VJ5M+3y7NbJF5DKPcBQqZESTWnbgLK9lVYST5jUAtRBVNmGkuqAommHbHY83Gm9yz8CoLivMhCOQfOPHkD30NbsCGhwBRo2Q5Og0ugHlO2bZJi2EXp9YEDhHPC+AoxFPjPQHFCHAXUCoCAtPrz4J52S7LxL5YOuQuX9JXSzI2LQ7boCoKKRpYVdABQwKMegUq19mCyBVgE0Lxa2k1UENHBAhRsAhqAFQD1LLpSE7KSmNf2A1hOe9dU3FUD5mMyAS5HGoJ6loH9K8RjasvTGjqKLh68GWQkoiw0IoAlh9DAeAwqseAYe3IRgQzzpU2f7TS5+b0B1vPpmBaCebYfGHBftRMqscjA57wUxaDanYgzaASjfkAJK9x9ADAoOIleocgwKmigKw5ZxFMD4LR8/1AEW9Abj4rl3gUspoKz88mLSd6xqQUslJ6xcGIMmD70xBhUAdSCRDCjJH6cZt58LJZdIcdhykJcvAJT5JqKTVJL2AdQzz8NjUECfL5Re3oVAIydBsqAQ0MJmVUDdAkDZDjzOH98kE6Aktp5fekeOAvdkZoD2EXofgHI30AA00FIePb8vIMcCSmFSDMfQz3QR64A6vmauzQSaoMKnOISOrCkD6iVAXcxsWppuUA+2luwAjG7Q2tAAD2ZUq8gf8yGvRdl1iAFaChsBgQKg6UVgJBsGaPsAhLXjNeaAojqKSJ0LmJZK0riuaHmLgMKj5UY9AYotLQY0b8+L3m8AtJryoA95LciuR8zuoRLwDFBu9rJPFgDlM9hCCocjxKBdgBLX7FAqyldRFUDRpBNXFADNB0pKyCNDXYaJhks3AvQWH/LqB3QqUL4iB0yiLSZ5ghfdSGUH3usAlLwkFiKxCShbImoNoCDCxI/nZ0BB9Y29JYC9lhHM0QLMUzcC9BYf8ioAil10Mo9pFgEqxUoBFhANPMul7MlEjkEdHTPR4+LBij0BxXcLAhRHFS4+cUpLqeMWABVGdSoB9BYf8qKA4gjIAyKZzUxzEqBxWQPI5uFNV9ElQDEmqNYNF5NUYQWgtcNy9DDytCOQz2NNKfHxHhdcPLWfHk+jdTUdFoNe80NezO4RQMFvMYQUR3d5vqJQ/oWjgpM1QFmMyd6XHA1cF6BCnUpKxAGNfx2GPL4etxmDFmKenBZO3ArQ63/IiwJKSmI9oHA5dvE+7rV6PeDK2EiDASXBJjF9IN3hgIKKkUN7isYzV52wMfDQxfuUCy9jCqi4jqrU2Bx1inbQxYDiVNNcoRCkmBNSXjUD8CJVAW3HoKguXUvZsRbmiTeRAAX2nWU9wxMB9SAdAVRw8T2A+oZVPgrQj+fG49CrAyoWwp4xKADUYUDBmz2QfWT80Lp1WTsAyq18cGyjGUlYSfIFC+p7AZWCtXKpr3bx1SrSa3ztyFvp/SOHAFp9i0ApBiUrYolN0PXFoC4COhPGXpEYEhqQP/5OkHAwoDnOFAHlG813b07hE6Bc+LL4TkAbQei6StLl72slCAVdRksDQxYDWgl2WoAW41K4MXHxs+WoPYTLVyA/hwkEUNy+yC4/iUGvAGiOJAqAsqxLMWhcLUwuA5SaH6w1zUxT9b3SzAS6jJZaS48BFK1lHocKeCovTI0p6h4/Qt8EtPoCkTkhdrEHufi8G3hzFAGdDajDlSeh50nTxXu+Rd7BroB2vH7xuhY03arkBQLNaBLglwe8eZwi9MAwx6CppowBjct4XpQLuLsuBBsqxKAM0LKLnx2Jgz6e+YG4grmiPkDZMqT1FrQ2qjM1ku4Xg85/cHVGAjQnEOfADLSPIDMYXFYiLhSDwnqxBGjQAWhuaypCyQH16IyKgCLD6ekY1zKgB8SgI331hvrme8KXAAp9L2Y1Awr6KfGuT3AeYOXwfBHQYp0ghqDkfxcQoCgGLZ2juw6g4D4oQcl2jJ89eAI3Sph+PekrCo0HA9TvC2jqUb+pU/0OgOaFAXb05DWlwtlDQFHHRpAkpysf2Pz4iAIat81+PzQARQzrAHS2oA4tLgAKC555bgqoBzM7A7pJme2+9MCHU0DT+riaFkorBnUwBl0FaEwFrQquFdGxGeWsIKCumrJfawCVY9B8ImULii0DvVAFQAP+5VL+JEkEFJxcniWdP3EuMBhKU074ogW5mzFkcCHMyuGLFgElod4NAKU7QIDSdXFSAjT0ABoIoL4AKL6G40ylNU/5+0HB3UYA9eD/aX0uHxqDyjO0XwQwxynJ9KcEaI5BWetQ6gyCn773ufhjAE2PtKqASjsmG5QAxdShovRk0uOku1rQj+dmP7uOMHUpoF4ANEiA0tYOaGWxCKDxZqYpyoCCGJR3mU9PPiN2DUDTbg4ENCwGNLl4DKh4dCDIkqoByH6QJutdAe15ccPHc8u8LgAUxJi0bigCCreVpmeNQKCsFgMaFwBAoQmFl7KNHeySV0Bgk4iLbx7GKB6Dhh5A8eZBABTHqLu6+K5X33w8Nz6UuBjQwAHFXr7U0ibkOIoCCi11TNIZg6KlMHt0KaG/F3QFQJ3QJ7l4GKNADIqi6VoQii8PmyaA5oBV1ooY9PdfOrqCvjX6My8DNM7kgUXQtFJA2ZAaaW5uQqeEonidPxkK6PqCGDT755hsrlo4dF0rlSTQun8MoA6EodWEws2W/4YeQIUYtApoxaasAfTrdStJ+bQTlR4H2RBQVBTzj/RInQHq8z5AmvHvIkAxo87BFTUDigAt1kM2yHXmLACKfUTDxRMw6TLJxVds6BoXv+kzx8v2m70uNpsBATpN0hg0pxMBDSwGRUU7pokWtNxQOGcFPTRYTmPQGhuk891BgDZz5nbe0aCjDShYNv96BCgwsnFZKQzV/be/AHoAABOtSURBVHY7YRQxtpDSy5UYpGLvGwZo2AZowHzNG5KFXTHotJMjAM31pEYylCS+w3FpDAosZQXQGIPuB+g13w+KW3sToDlugUXC/EqIRpR75UQLj0HBfHJtXYCCyQQo9KjdMWg4yoJ2ATolBROOLay31MPafBwWCoNNDwFFjl/SUZWk/uyg6EF6emYcorwZjoAciAYEF88BBTFouiSLAM2GJmFKm9+rMahDc+WUa7UeUFpJqj/rxM/0UuudACi1DpJ0vX6xACi8CakbphsDE5nCHMfHbjiQJG0O4J4Sdbn4dAHJdaR9MFoxqBJAodEEW7gOQHFgGRdRQIMAaPmq6noWT0NC9KolDqgXN5uYjEUIRizApBxQkDd+LNSyoNLlcjHlghj0cEBp74BCMrB/8AiJxCrytgJ16RFg8um5Kx50j6cGFKxG76eLZ0eqRxlQnyxozjGEMMeGQgzqEd25eaUMKK0HgWUOt+o0YtCgBFC4f/SMsx2DStRBGsP01nAB0Dm5IF2vX6S4wIHE+XRpDIpO0mdAE44hunhsP4UYNAPqAgS05LhDrvSiCbIuLq0ZUF2AAkNKG9CKbf2eUxd7lUcXnwAVuinvBuiBr1+UAUW1n7IzmLeZJmANKAMalaJFKV7KYGUXD+2gAKiLyXLmeIrmIklRDBp/AKAOrqGHN82icGySj8T67OKDACirMiXpev0iHZwBAc0piEdPvyAdrtbMJZhLwcViprZYAJTWEIhFlS2jS3tFx1HlTi+g8zxYIwIaKKDJpiS3B+JRGg3sBuiRr19ko4c8PWP8juQIJrKxgxy0jxlQj5fA8DDuP8asCFAUgAmA4mwSB6yW1MtnNRhYK7nrSzl5TExLiZwVWBOIAcn+PeTqgU9WFFyQlIBJ1+sXq4DmEKcYg3rMJHfxeQn4yQZWBJQB6YR56OIRsYjkKqBo5XGA9hpnAGgzBk0ung7mBBcxAZqCN25vBel6/SIHFLegTT+lGNTXAYURwPRXAnSaJYACv86Nr/AkMAiENQGtzO2iXgvK/EDAG0oxKAmhshKgbMD4YTHoka9fFAYIk4e0OCYtx6DwEs8zoBBgHWhOAffPXTxocEp1BpgVu+qpKQa6+AWR5QGAxjPpBxTdeciQioAOIhcrFzr088CYws1EQlW1gyLjyM+CV5pYDErDTjqDABVi0ClBKQadljEXL56gw5c3b1nS4Ra0F9CcWnQNYgyK5kkVgVwd8Kyz2nF3ln5A6Wre76UYg4Y8g7cpxqAIUEdj0NnbQ+ubnoOKlx2HlXU0jge05yjyviOdjhaX4z4+u3j4i/voZEBDdPkHALpPX7vSflFgkgAlN2Rl/IqHRYPoq8eg6LFTkAB1ANDQDyjWEugOBLR3344A6gCnpEaHARV25dGlnA0pNUdnBBRMzGfrpZYJii50wrGUGZ8U0IABTX4+p5ABRXkCsSVL+tDdEtB0CA4dMwSU+AbxcEkXnYygVNsVnixN0g5oPmYXq4TCo3dP7kAA6DQp+08GaAAuHgFKXTzgsnzBHb2MGgDtz5kCiu5rYkHRyeXbXAIU9GXiz2W4dAPqOaA8BmU1JAbo8BduhGxBiFchB70RT1ZJShYUAVq85FcKK5epOxZJgJL7mcegbm4bRZUiVDA4BoVxKEghajGge7w5rLRfD2+r3EAxzWdA5S1DBdCh8KCLFwGFm0dAHQY0hWS8i8hptAxQ0HWpEoNiQPPSNO2JBZHspyxdFtQjQOkNOacpxaAkyKQunseg+ULwSqmLfp4A6gRAS+oIS2+gZS4eNRaD6JMFL7wgqIv3xI701OF1A4rDkhiDMscgnC8GlAV/FUCRiwebzoZ4GaBsr+cCNPUnQJvyRgvSjS8bFIcMh8//o1iNbEekFtD53HgMWnoUj4LMwGJQZEHJOuDicQyKAXW5kR4C2mtCNdAZ+g4DBqG4awECFJefwwYy2VSfLiaepIDK0gVoyI/e2cAVbOTqagEa8Lp4EcCupBg09pLAgGoBr1ddhwsf8jq0EIc8cJLEoPHWTRUjj+OzPF09IlVPkoIngE4TkxJEpdh6FxeftyEx6JwPqMgzV8fEVmpgufMYXLKgeZEIqMOliTOAndFYrx8C6C4ufjeVOosAQAP6BYDiGDQlrAGKS48BSsyzEIMmKjOg0aqWRS+ZBj4X3CTwBs2b0n4zDFAf4g3scu3VIZMDY9CGZ1QGaGgCGuiZsIRBcPF9gPoGoNDFZ0C7r7gKPpcdBTGh2XEDQPMqxGMuumlgbfAB2VBPAZWlC9DcGJFNI3HxPYLPOrKHBusDWVeIQUEpx9bpKef4nxA+qFfv4aZCQjGoy0DOBZfKeZjwMGVcMhGLRkAGFKvVDkkZoPA5WFo0KRaUx+mladwLiXtiBGisDOH1zgmABgHQJXiqQHkBoCDmHKcAkMmLwHZSsO1ceqB7GXo9E6Q5W1rpMFQBCoYV84PNgHoY74Bq4ZyOxkqkmMFMAhQHQk4ANM5EQOPmSwBVweeSo6DuwWVvUwbUh7TcIeuChpKNgMakeTGXMkCnyp44qgPFoIkQAWSEJPbmZCYCCkKoOYAqAhryOhCH9UkHoMuEGHXp1FP8SVpJPQE0rXPQ7vjZuBJARakCdFRqMyPL0Xlg+nA6tDaXp5BTwi0DCjMXAEXT0Jreodi9jXyNDGjwOSUqUhe8x49dPE5bkjJAfRtQn2dkQB0CNIeQOQWacNlYgj0VmpmycQYu/07F7j1UTKiUyVTILgYDOgvFoA5fWSpVgPKaUVYqnbHRAlSDWEIMaNocZgUnHCz5RH8NUJDnEg9/PrlAzi6WVciFL1vQ1IQa5x2OQfNDJhgKSIQqAzT/pcIQ1QAlLj4E+BvQdimXWJqpZS5FUeBCQDDz7x0DOogWcioPdt7IxbM7OQTi4oNngEpSBego2B80yQXshllHG5C07eIdnIAg+rxhMqQJUJgHMK93CygzkQg6ft60eLIFHbejMSgo7FqgpA1Q9gh+VEQlQlQLAJfEoLOtJPiBZmZSKSCZtGqgJ1cNwepaxwB1A6AwLXdiBakCVGz/nJWrkD5Ff9J5OQJo2jxP4LAJAQpj0CKg0I7fPaBFDvmZoxsfu/j0XD5FsA7GapWD0AZokCtIAfvhivnKT9ZLgDoK6Dg1ZQ2eDrMYFLZOwY3uW+wUi6dMrGLAhe9m85NLzp8P0EG0s8ig+SRQjaVUgaaA0kgKAppLZ37aWYtByRsdx/8eAFAag1YSSi4m/VBAUQxayVkboPT13kkOUrQN0JyWAooSEBcvVGfv3MUzNU4W3/hgSQI0rcrX6HSA4lnkjVMtKTbTFwB1EFCaEdoKufgYFYGbXIw8c86uec3uQI7Mlc84lVu+qfOKDGgqV5+yq5SiNkAHoV5v8wQANCRClsWg6Z4txKAioCQeyPt4GG0EFMajHgEKPkl1JkBzf9AEVTJYLjh0QiULCtZWAUUuPhBAAwaUvlT8wbz7qC4X77DXyRdx6oaWvR+qkBYz1Qho/KE2KwHKH7Pluex2UQUxlRN18dmAps0QoCR7uK0Tlt61GiFNE9CAAJ0Tx59CzuoABXKZqgRoWjH+0tShCuhMnARoaAMa0GbC5AOoXitsAApySP4KeMQTAZp6wMRx6A78m1YF+BOTx2UQsLRWBDSAoKEAKMyB7OrxVDehTUD93PQxW9AMaCW01Qho6kYQ/UGiqwgoen4kWcCchcOkCYa3DShbYgolQFNFfR47l108BLR4z6sEFNSR4t0n1nxwhCm5eNS6OQMKdgPaBRwDNOZB9hXgksdjdLEFzYCGVGRpoWPFT6UU0EEu2TvgrIuABgYoBshFd4PjgkoMGrdqHOODaT2gaUHsVuGxg5MzPQjQj+fGKxrr2eUWiFxRmtaUAKXef57kgJLvsud8VwFqAooXwBUA9bNTgzFoSlkq6WMAfX2aP+T59lT4omefi0fePYRQADQ6DmIgkYtPESiNQVEWYQmgBi9WumBwSfbmPgIaUEA2p7wqoMPH6Ga9Fr5H1+fiAzP+EqAuVwwxzKgHUgKUpEg5OZgyJ6geoDEKxC0KcFnO+QARTv4xpiwU9SGAgnfgkS965vczt3NZAGg+ZznCnFJNCwoxaMGCdh2jaVRkTrag6Q8IyGDKawK6qwWlQWPggOY5VwZ0trKkHHg1/SH60B2iKqAhWVAR0OK9flQMOpvQtTHoIB5zhxTBkCQhJS0BmosGFwo3lwt6ghjJSDNz6J4HnkkToOljC8UvIovZOWGOunga4yBcq4C66OZJdmyH/YAaoVAgwkxLUJRPQjIWkElS1Q4qHa8QgxYBpW8BY63yVfbcckB7Ez6GJBdfBpTXGMTiVA8oDySpi4cWtFJJwhGRsM/lgJqQREBDP6BipicAlN9mZQtaBjSWTQVhHNF2yEhGkrw2vgC1GPQ0gDo4EyRASy6eOQn0hQpeInTe5XR9MkCxBKOIr1U0po7GaoHNRZ0O0FADVMwwT9e9txMKzbRE3YAGamlCOC+gkpWT5+qAjvOsEJCHZwVsWiQJUGmlKySWpAtQVh1CEymJdFeK4vmxIIAmN0DXqwUo6zN5RkBlLnGSDYDWUpiL36gmoCRx+aleli5AAzinAigU0EX9jarwWQy6WawVz90XoDCmLIGCznM5oNXU5uK3iTVENwCliaU8lQGaz6IIKHIbS+1dPbkBuk0c0IaLL6UFUgcoHAVQSpJn9uXJAN2qTYCKZa8M0GwUS6Dg89rVgpqL36yFMSjbmssAhSuFQjP1a6OLF6UN0Ny/tbCh1IWzX430Bug21eoEvBuEAbpYBuhGVZ7U3RGgoLFJSnIcQ60eo6amWH8dOOVIyjMCGi1k0VcYoJpVc/H3A+g4dQtAzcVv1QPEoPGwDdBTqlJ8vK/4+QDNTZHFY+88r1USmklMy7QA0L7HgOcD9ECGDNDNqgHK+iffJ6D7Hod4AKbV6ge00xgoAzQ0AT1aBugm9bv4zp4+Bqiwc9MRug9AB7mbeVqj80BVXotVkQFqupL4oPCerZQCajHo/emOAL1Ze7k11B+ouwLUYtD70x0BajHoPar20oyytAK6795MCnRHgNpbuO9R9wOoPRG/SxmgJt1adVENUNO1ZICaVMsANd2fDFCTat0MUJOpSzcC9Fr7OOSwjymLo0r4QYrAAD04UwPUAFWdqQFqgKrO1AA1QFVnaoAaoKozNUANUNWZGqAGqOpMDVADVHWmBqh+QE2m1TJATaplgJpUywA1qZYBalItA9SkWgaoSbUMUJNqGaAm1TJATaplgJpUywA1qZYBalItA/Qg/f76I06+f/9RS2mqyQA9XgboBhmgx8sA3aCDAH19enr6Nlyav39/evqRF6zV769DRt9+f51ye3kaf9///MfTH//aN8+XL8PRfll/qCn3HyOYlz97ATocKSzM33/5X183leqgfInexlyn0OTt089t2e4GwDGAvl7O7/fXb5fju0y8zv+GBWv1++uQyUDj6+XfANGQ4/v3z7/WH6Sc59tl+uN5O1H7Azqi83a52rEwL8D+GBdsUbpEQ0bv3798PA8358uWgg17AnAIoO/fhyO5XOpxYrxU84K1OY7nNv/58f7nz+lyTdnuneePi2naaD/CEYDG4kuFOV3w120sxUv08Tzm+unncLduK9hdATgE0MlBgEuUFqzNcdw0/xn90Y+NwZ2c52BKN17zmPvOgL5/n65vKsxdvHE8yCmz+ai3evgdATgG0PkNZvn44oK1OWKYLvHMH//5dV9AY57Dbf6yMa6bc987Bv14HoswFeZk6HcFdJi73KFbPfyOABxoQUM++80xN4IpzewIaJ55//N//7ndwx8B6KCXTz9TYR4A6PD37Y9/bj3gHQE4KAb9ASb2uEQIpjGUedvXxac8L3bqv+3g4VPgFUHdSbAwpxh0o7WLlyjFoJeZf19fWQCZwtzXF8FxtfjhZo/HlxaszZBZu/fvT9/2tqBjnkODyA4efqp3fP51ccu7VZKG4nuba8RDYY7NENtr8fMlmmvxYWhw29zKth8AB7aDjrXB+fjigqkRY7lYvPjpZzz9tVkW8pw95+pcYe4X4p/+PpqPzdkNGgK58RLPhfn7639Mbbhbcs+X6C22VL5tzTPsCIA9SWL6/W87ePgtTRaKdnF7GaBMr3t4+F3aUlu7MEAfUL+/7lFF2iOOa8oANZluLQPUpFoGqEm1DFCTahmgJtUyQE2qZYCaVMsANamWAWpSLQPUpFoGqEm1DFCTahmgJtUyQE2qZYCaVMsANamWAWpSLQPUpFoGqEm1DFCTahmgJtUyQE2qZYCaVMsANamWAXqE0NsG3x7g9QrHyQA9QhBQ+8bHJhmgR8gA3U0G6N4a3uP4j/FtmOMrr4dvx3z+lb7Ckj4lY+qTAbqzXv74V3gbXuOZv5XzI4Avx8yfkjF1ygDdV9Mb54aX68Lv2qSvsGz4Es+DygDdVxOBcwyavpUDPstihC6TAbqvXhOg8Fs5+Sss86dkTL0yQPdVsqDoWzn4KywbPibxeDJA99UUg17qROhbObipyRqeFsgA3VnTd1knCzp/K+db/ixL+pSMqVMG6N6K7aDpuzYvsR10sqnzp2RMfTJATaplgJpUywA1qZYBalItA9SkWgaoSbUMUJNqGaAm1TJATaplgJpUywA1qZYBalItA9SkWgaoSbUMUJNqGaAm1TJATaplgJpUywA1qZYBalItA9SkWgaoSbUMUJNqGaAm1fr/3yH/FylGyaUAAAAASUVORK5CYII=" /><!-- --></p>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Objects of class <code>SpatialGridTopography</code> can be initialized with user input values for slope and aspect too, but <code>meteoland</code> has its own routines when this are missing<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
